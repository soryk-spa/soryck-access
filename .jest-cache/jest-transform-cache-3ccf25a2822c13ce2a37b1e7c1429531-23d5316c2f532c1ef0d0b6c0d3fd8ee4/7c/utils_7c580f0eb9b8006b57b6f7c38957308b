63e1971a1499f7b4318e5486d3642d2b
"use strict";
/**
 * Utilidades centralizadas para formateo y operaciones comunes
 * Elimina duplicaciones y proporciona consistencia
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.cn = cn;
exports.formatCurrency = formatCurrency;
exports.formatPriceRange = formatPriceRange;
exports.formatNumber = formatNumber;
exports.formatPercentage = formatPercentage;
exports.formatDisplayDate = formatDisplayDate;
exports.formatDisplayDateTime = formatDisplayDateTime;
exports.formatTime = formatTime;
exports.formatShortDate = formatShortDate;
exports.getRelativeDateDescription = getRelativeDateDescription;
exports.isFutureDate = isFutureDate;
exports.isValidEmail = isValidEmail;
exports.isValidUrl = isValidUrl;
exports.capitalize = capitalize;
exports.slugify = slugify;
exports.truncate = truncate;
exports.getInitials = getInitials;
exports.formatFullName = formatFullName;
exports.groupBy = groupBy;
exports.sortBy = sortBy;
exports.unique = unique;
exports.formatDiscount = formatDiscount;
exports.calculateUsagePercentage = calculateUsagePercentage;
exports.getStatusConfig = getStatusConfig;
exports.debounce = debounce;
exports.formatFileSize = formatFileSize;
exports.isValidImageFile = isValidImageFile;
const clsx_1 = require("clsx");
const tailwind_merge_1 = require("tailwind-merge");
// ============================================================================
// UTILIDADES DE ESTILO
// ============================================================================
function cn(...inputs) {
    return (0, tailwind_merge_1.twMerge)((0, clsx_1.clsx)(inputs));
}
// ============================================================================
// UTILIDADES DE FORMATEO
// ============================================================================
/**
 * Formatea un precio con la moneda especificada
 */
function formatCurrency(amount, currency = 'CLP') {
    if (amount === 0)
        return 'Gratis';
    return new Intl.NumberFormat('es-CL', {
        style: 'currency',
        currency: currency,
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
    }).format(amount);
}
/**
 * Formatea un rango de precios
 */
function formatPriceRange(min, max, currency = 'CLP') {
    if (min === 0 && max === 0)
        return "Gratis";
    if (min === max)
        return formatCurrency(min, currency);
    return `Desde ${formatCurrency(min, currency)}`;
}
/**
 * Formatea números grandes con sufijos (K, M, B)
 */
function formatNumber(num) {
    if (num >= 1000000000) {
        return (num / 1000000000).toFixed(1) + 'B';
    }
    if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
    }
    if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
    }
    return num.toString();
}
/**
 * Formatea porcentajes
 */
function formatPercentage(value, decimals = 1) {
    return `${value.toFixed(decimals)}%`;
}
// ============================================================================
// UTILIDADES DE FECHA
// ============================================================================
/**
 * Formatea una fecha para mostrar en la UI
 */
function formatDisplayDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleDateString("es-CL", {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
        timeZone: "America/Santiago",
    });
}
/**
 * Formatea una fecha con hora
 */
function formatDisplayDateTime(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleString("es-CL", {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
        timeZone: "America/Santiago",
    });
}
/**
 * Formatea solo la hora
 */
function formatTime(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleTimeString("es-CL", {
        hour: "2-digit",
        minute: "2-digit",
        timeZone: "America/Santiago",
    });
}
/**
 * Formatea fecha corta (dd/mm/yyyy)
 */
function formatShortDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleDateString("es-CL", {
        day: "2-digit",
        month: "2-digit",
        year: "numeric",
        timeZone: "America/Santiago",
    });
}
/**
 * Obtiene descripción relativa de fecha (Hoy, Mañana, etc.)
 */
function getRelativeDateDescription(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    const now = new Date();
    // Verificar si es hoy
    if (dateObj.toDateString() === now.toDateString())
        return "Hoy";
    // Verificar si es mañana
    const tomorrow = new Date(now);
    tomorrow.setDate(tomorrow.getDate() + 1);
    if (dateObj.toDateString() === tomorrow.toDateString())
        return "Mañana";
    // Calcular diferencia en días
    const diffTime = dateObj.getTime() - now.getTime();
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    if (diffDays < 0) {
        return diffDays === -1 ? "Ayer" : `Hace ${Math.abs(diffDays)} días`;
    }
    else if (diffDays <= 7) {
        return `En ${diffDays} días`;
    }
    else {
        return formatDisplayDate(dateObj);
    }
}
// ============================================================================
// UTILIDADES DE VALIDACIÓN
// ============================================================================
/**
 * Valida si una fecha es futura
 */
function isFutureDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj > new Date();
}
/**
 * Valida email
 */
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
/**
 * Valida que una URL sea válida
 */
function isValidUrl(url) {
    try {
        new URL(url);
        return true;
    }
    catch (_a) {
        return false;
    }
}
// ============================================================================
// UTILIDADES DE TEXTO
// ============================================================================
/**
 * Capitaliza la primera letra de una cadena
 */
function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
}
/**
 * Convierte texto a slug (URL-friendly)
 */
function slugify(text) {
    return text
        .toLowerCase()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '') // Remove accents
        .replace(/[^a-z0-9\s-]/g, '') // Remove special chars
        .replace(/\s+/g, '-') // Replace spaces with hyphens
        .replace(/-+/g, '-') // Replace multiple hyphens with single
        .trim();
}
/**
 * Trunca texto con elipsis
 */
function truncate(text, length) {
    if (text.length <= length)
        return text;
    return text.slice(0, length) + '...';
}
/**
 * Obtiene iniciales de un nombre
 */
function getInitials(firstName, lastName) {
    const first = (firstName === null || firstName === void 0 ? void 0 : firstName.charAt(0).toUpperCase()) || '';
    const last = (lastName === null || lastName === void 0 ? void 0 : lastName.charAt(0).toUpperCase()) || '';
    return (first + last) || '?';
}
/**
 * Formatea nombre completo
 */
function formatFullName(firstName, lastName) {
    const parts = [firstName, lastName].filter(Boolean);
    return parts.length > 0 ? parts.join(' ') : 'Usuario';
}
// ============================================================================
// UTILIDADES DE ARRAYS Y OBJETOS
// ============================================================================
/**
 * Agrupa array por una propiedad
 */
function groupBy(array, key) {
    return array.reduce((groups, item) => {
        const group = String(item[key]);
        return Object.assign(Object.assign({}, groups), { [group]: [...(groups[group] || []), item] });
    }, {});
}
/**
 * Ordena array por una propiedad
 */
function sortBy(array, key, direction = 'asc') {
    return [...array].sort((a, b) => {
        const aValue = a[key];
        const bValue = b[key];
        if (aValue < bValue)
            return direction === 'asc' ? -1 : 1;
        if (aValue > bValue)
            return direction === 'asc' ? 1 : -1;
        return 0;
    });
}
/**
 * Filtra valores únicos de un array
 */
function unique(array) {
    return [...new Set(array)];
}
// ============================================================================
// UTILIDADES DE PROMOCIONES
// ============================================================================
/**
 * Formatea el descuento de un código promocional
 */
function formatDiscount(type, value) {
    switch (type) {
        case "PERCENTAGE":
            return `${value}%`;
        case "FIXED_AMOUNT":
            return formatCurrency(value);
        case "FREE":
            return "Gratis";
        default:
            return value.toString();
    }
}
/**
 * Calcula el porcentaje de uso de un código promocional
 */
function calculateUsagePercentage(used, limit) {
    if (!limit)
        return 0;
    return Math.min((used / limit) * 100, 100);
}
// ============================================================================
// UTILIDADES DE ESTADO
// ============================================================================
/**
 * Obtiene la configuración de color para un estado
 */
function getStatusConfig(status) {
    const configs = {
        ACTIVE: { label: "Activo", color: "bg-green-100 text-green-800", variant: "default" },
        INACTIVE: { label: "Inactivo", color: "bg-gray-100 text-gray-800", variant: "secondary" },
        EXPIRED: { label: "Expirado", color: "bg-red-100 text-red-800", variant: "destructive" },
        USED_UP: { label: "Agotado", color: "bg-orange-100 text-orange-800", variant: "outline" },
        PENDING: { label: "Pendiente", color: "bg-yellow-100 text-yellow-800", variant: "outline" },
        PAID: { label: "Pagado", color: "bg-green-100 text-green-800", variant: "default" },
        FAILED: { label: "Fallido", color: "bg-red-100 text-red-800", variant: "destructive" },
        CANCELLED: { label: "Cancelado", color: "bg-gray-100 text-gray-800", variant: "secondary" },
        REFUNDED: { label: "Reembolsado", color: "bg-blue-100 text-blue-800", variant: "outline" },
    };
    return configs[status] || {
        label: status,
        color: "bg-gray-100 text-gray-800",
        variant: "secondary"
    };
}
// ============================================================================
// UTILIDADES DE DEBOUNCE
// ============================================================================
/**
 * Función de debounce para optimizar búsquedas
 */
function debounce(func, wait) {
    let timeout;
    return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
    };
}
// ============================================================================
// UTILIDADES DE ARCHIVOS
// ============================================================================
/**
 * Convierte bytes a formato legible
 */
function formatFileSize(bytes) {
    if (bytes === 0)
        return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}
/**
 * Valida tipo de archivo por extensión
 */
function isValidImageFile(filename) {
    const validExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp'];
    const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));
    return validExtensions.includes(extension);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxCaWx1clxcRG9jdW1lbnRzXFxEZXZlbG9wbWVudFxcTmV4dFxcc29yeWNrLWFjY2Vzc1xcc3JjXFxsaWJcXHV0aWxzLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBU0gsZ0JBRUM7QUFTRCx3Q0FZQztBQUtELDRDQVFDO0FBS0Qsb0NBV0M7QUFLRCw0Q0FFQztBQVNELDhDQVVDO0FBS0Qsc0RBWUM7QUFLRCxnQ0FRQztBQUtELDBDQVNDO0FBS0QsZ0VBdUJDO0FBU0Qsb0NBR0M7QUFLRCxvQ0FHQztBQUtELGdDQU9DO0FBU0QsZ0NBRUM7QUFLRCwwQkFTQztBQUtELDRCQUdDO0FBS0Qsa0NBSUM7QUFLRCx3Q0FHQztBQVNELDBCQVFDO0FBS0Qsd0JBU0M7QUFLRCx3QkFFQztBQVNELHdDQVdDO0FBS0QsNERBR0M7QUFTRCwwQ0FzQkM7QUFTRCw0QkFVQztBQVNELHdDQVFDO0FBS0QsNENBSUM7QUE3WEQsK0JBQTZDO0FBQzdDLG1EQUF5QztBQUV6QywrRUFBK0U7QUFDL0UsdUJBQXVCO0FBQ3ZCLCtFQUErRTtBQUUvRSxTQUFnQixFQUFFLENBQUMsR0FBRyxNQUFvQjtJQUN4QyxPQUFPLElBQUEsd0JBQU8sRUFBQyxJQUFBLFdBQUksRUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0FBQy9CLENBQUM7QUFFRCwrRUFBK0U7QUFDL0UseUJBQXlCO0FBQ3pCLCtFQUErRTtBQUUvRTs7R0FFRztBQUNILFNBQWdCLGNBQWMsQ0FDNUIsTUFBYyxFQUNkLFdBQW1CLEtBQUs7SUFFeEIsSUFBSSxNQUFNLEtBQUssQ0FBQztRQUFFLE9BQU8sUUFBUSxDQUFDO0lBRWxDLE9BQU8sSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRTtRQUNwQyxLQUFLLEVBQUUsVUFBVTtRQUNqQixRQUFRLEVBQUUsUUFBUTtRQUNsQixxQkFBcUIsRUFBRSxDQUFDO1FBQ3hCLHFCQUFxQixFQUFFLENBQUM7S0FDekIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FB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Q0FBQyxDQUFDLENBQUM7QUFDMUUsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsZ0JBQWdCLENBQUMsUUFBZ0I7SUFDL0MsTUFBTSxlQUFlLEdBQUcsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbkUsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDOUUsT0FBTyxlQUFlLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzdDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCaWx1clxcRG9jdW1lbnRzXFxEZXZlbG9wbWVudFxcTmV4dFxcc29yeWNrLWFjY2Vzc1xcc3JjXFxsaWJcXHV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBVdGlsaWRhZGVzIGNlbnRyYWxpemFkYXMgcGFyYSBmb3JtYXRlbyB5IG9wZXJhY2lvbmVzIGNvbXVuZXNcclxuICogRWxpbWluYSBkdXBsaWNhY2lvbmVzIHkgcHJvcG9yY2lvbmEgY29uc2lzdGVuY2lhXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgdHlwZSBDbGFzc1ZhbHVlLCBjbHN4IH0gZnJvbSBcImNsc3hcIjtcclxuaW1wb3J0IHsgdHdNZXJnZSB9IGZyb20gXCJ0YWlsd2luZC1tZXJnZVwiO1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBVVElMSURBREVTIERFIEVTVElMT1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY24oLi4uaW5wdXRzOiBDbGFzc1ZhbHVlW10pIHtcclxuICByZXR1cm4gdHdNZXJnZShjbHN4KGlucHV0cykpO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJREFERVMgREUgRk9STUFURU9cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEZvcm1hdGVhIHVuIHByZWNpbyBjb24gbGEgbW9uZWRhIGVzcGVjaWZpY2FkYVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEN1cnJlbmN5KFxyXG4gIGFtb3VudDogbnVtYmVyLCBcclxuICBjdXJyZW5jeTogc3RyaW5nID0gJ0NMUCdcclxuKTogc3RyaW5nIHtcclxuICBpZiAoYW1vdW50ID09PSAwKSByZXR1cm4gJ0dyYXRpcyc7XHJcbiAgXHJcbiAgcmV0dXJuIG5ldyBJbnRsLk51bWJlckZvcm1hdCgnZXMtQ0wnLCB7XHJcbiAgICBzdHlsZTogJ2N1cnJlbmN5JyxcclxuICAgIGN1cnJlbmN5OiBjdXJyZW5jeSxcclxuICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMCxcclxuICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMFxyXG4gIH0pLmZvcm1hdChhbW91bnQpO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0ZWEgdW4gcmFuZ28gZGUgcHJlY2lvc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFByaWNlUmFuZ2UoXHJcbiAgbWluOiBudW1iZXIsIFxyXG4gIG1heDogbnVtYmVyLCBcclxuICBjdXJyZW5jeTogc3RyaW5nID0gJ0NMUCdcclxuKTogc3RyaW5nIHtcclxuICBpZiAobWluID09PSAwICYmIG1heCA9PT0gMCkgcmV0dXJuIFwiR3JhdGlzXCI7XHJcbiAgaWYgKG1pbiA9PT0gbWF4KSByZXR1cm4gZm9ybWF0Q3VycmVuY3kobWluLCBjdXJyZW5jeSk7XHJcbiAgcmV0dXJuIGBEZXNkZSAke2Zvcm1hdEN1cnJlbmN5KG1pbiwgY3VycmVuY3kpfWA7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3JtYXRlYSBuw7ptZXJvcyBncmFuZGVzIGNvbiBzdWZpam9zIChLLCBNLCBCKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW06IG51bWJlcik6IHN0cmluZyB7XHJcbiAgaWYgKG51bSA+PSAxMDAwMDAwMDAwKSB7XHJcbiAgICByZXR1cm4gKG51bSAvIDEwMDAwMDAwMDApLnRvRml4ZWQoMSkgKyAnQic7XHJcbiAgfVxyXG4gIGlmIChudW0gPj0gMTAwMDAwMCkge1xyXG4gICAgcmV0dXJuIChudW0gLyAxMDAwMDAwKS50b0ZpeGVkKDEpICsgJ00nO1xyXG4gIH1cclxuICBpZiAobnVtID49IDEwMDApIHtcclxuICAgIHJldHVybiAobnVtIC8gMTAwMCkudG9GaXhlZCgxKSArICdLJztcclxuICB9XHJcbiAgcmV0dXJuIG51bS50b1N0cmluZygpO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0ZWEgcG9yY2VudGFqZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRQZXJjZW50YWdlKHZhbHVlOiBudW1iZXIsIGRlY2ltYWxzOiBudW1iZXIgPSAxKTogc3RyaW5nIHtcclxuICByZXR1cm4gYCR7dmFsdWUudG9GaXhlZChkZWNpbWFscyl9JWA7XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVVRJTElEQURFUyBERSBGRUNIQVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogRm9ybWF0ZWEgdW5hIGZlY2hhIHBhcmEgbW9zdHJhciBlbiBsYSBVSVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERpc3BsYXlEYXRlKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRhdGVPYmogPSB0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycgPyBuZXcgRGF0ZShkYXRlKSA6IGRhdGU7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGVPYmoudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZXMtQ0xcIiwge1xyXG4gICAgd2Vla2RheTogXCJsb25nXCIsXHJcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcclxuICAgIG1vbnRoOiBcImxvbmdcIixcclxuICAgIGRheTogXCJudW1lcmljXCIsXHJcbiAgICB0aW1lWm9uZTogXCJBbWVyaWNhL1NhbnRpYWdvXCIsXHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3JtYXRlYSB1bmEgZmVjaGEgY29uIGhvcmFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXREaXNwbGF5RGF0ZVRpbWUoZGF0ZTogRGF0ZSB8IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgZGF0ZU9iaiA9IHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJyA/IG5ldyBEYXRlKGRhdGUpIDogZGF0ZTtcclxuICBcclxuICByZXR1cm4gZGF0ZU9iai50b0xvY2FsZVN0cmluZyhcImVzLUNMXCIsIHtcclxuICAgIHdlZWtkYXk6IFwibG9uZ1wiLFxyXG4gICAgeWVhcjogXCJudW1lcmljXCIsXHJcbiAgICBtb250aDogXCJsb25nXCIsXHJcbiAgICBkYXk6IFwibnVtZXJpY1wiLFxyXG4gICAgaG91cjogXCIyLWRpZ2l0XCIsXHJcbiAgICBtaW51dGU6IFwiMi1kaWdpdFwiLFxyXG4gICAgdGltZVpvbmU6IFwiQW1lcmljYS9TYW50aWFnb1wiLFxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybWF0ZWEgc29sbyBsYSBob3JhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0VGltZShkYXRlOiBEYXRlIHwgc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIFxyXG4gIHJldHVybiBkYXRlT2JqLnRvTG9jYWxlVGltZVN0cmluZyhcImVzLUNMXCIsIHtcclxuICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxyXG4gICAgbWludXRlOiBcIjItZGlnaXRcIixcclxuICAgIHRpbWVab25lOiBcIkFtZXJpY2EvU2FudGlhZ29cIixcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZvcm1hdGVhIGZlY2hhIGNvcnRhIChkZC9tbS95eXl5KVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFNob3J0RGF0ZShkYXRlOiBEYXRlIHwgc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIFxyXG4gIHJldHVybiBkYXRlT2JqLnRvTG9jYWxlRGF0ZVN0cmluZyhcImVzLUNMXCIsIHtcclxuICAgIGRheTogXCIyLWRpZ2l0XCIsXHJcbiAgICBtb250aDogXCIyLWRpZ2l0XCIsXHJcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcclxuICAgIHRpbWVab25lOiBcIkFtZXJpY2EvU2FudGlhZ29cIixcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgZGVzY3JpcGNpw7NuIHJlbGF0aXZhIGRlIGZlY2hhIChIb3ksIE1hw7FhbmEsIGV0Yy4pXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVsYXRpdmVEYXRlRGVzY3JpcHRpb24oZGF0ZTogRGF0ZSB8IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgZGF0ZU9iaiA9IHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJyA/IG5ldyBEYXRlKGRhdGUpIDogZGF0ZTtcclxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIFxyXG4gIC8vIFZlcmlmaWNhciBzaSBlcyBob3lcclxuICBpZiAoZGF0ZU9iai50b0RhdGVTdHJpbmcoKSA9PT0gbm93LnRvRGF0ZVN0cmluZygpKSByZXR1cm4gXCJIb3lcIjtcclxuICBcclxuICAvLyBWZXJpZmljYXIgc2kgZXMgbWHDsWFuYVxyXG4gIGNvbnN0IHRvbW9ycm93ID0gbmV3IERhdGUobm93KTtcclxuICB0b21vcnJvdy5zZXREYXRlKHRvbW9ycm93LmdldERhdGUoKSArIDEpO1xyXG4gIGlmIChkYXRlT2JqLnRvRGF0ZVN0cmluZygpID09PSB0b21vcnJvdy50b0RhdGVTdHJpbmcoKSkgcmV0dXJuIFwiTWHDsWFuYVwiO1xyXG4gIFxyXG4gIC8vIENhbGN1bGFyIGRpZmVyZW5jaWEgZW4gZMOtYXNcclxuICBjb25zdCBkaWZmVGltZSA9IGRhdGVPYmouZ2V0VGltZSgpIC0gbm93LmdldFRpbWUoKTtcclxuICBjb25zdCBkaWZmRGF5cyA9IE1hdGguY2VpbChkaWZmVGltZSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XHJcbiAgXHJcbiAgaWYgKGRpZmZEYXlzIDwgMCkge1xyXG4gICAgcmV0dXJuIGRpZmZEYXlzID09PSAtMSA/IFwiQXllclwiIDogYEhhY2UgJHtNYXRoLmFicyhkaWZmRGF5cyl9IGTDrWFzYDtcclxuICB9IGVsc2UgaWYgKGRpZmZEYXlzIDw9IDcpIHtcclxuICAgIHJldHVybiBgRW4gJHtkaWZmRGF5c30gZMOtYXNgO1xyXG4gIH0gZWxzZSB7XHJcbiAgICByZXR1cm4gZm9ybWF0RGlzcGxheURhdGUoZGF0ZU9iaik7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJREFERVMgREUgVkFMSURBQ0nDk05cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYSBzaSB1bmEgZmVjaGEgZXMgZnV0dXJhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNGdXR1cmVEYXRlKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBib29sZWFuIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIHJldHVybiBkYXRlT2JqID4gbmV3IERhdGUoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYSBlbWFpbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRFbWFpbChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xyXG4gIHJldHVybiBlbWFpbFJlZ2V4LnRlc3QoZW1haWwpO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhIHF1ZSB1bmEgVVJMIHNlYSB2w6FsaWRhXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZFVybCh1cmw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHRyeSB7XHJcbiAgICBuZXcgVVJMKHVybCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVVRJTElEQURFUyBERSBURVhUT1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQ2FwaXRhbGl6YSBsYSBwcmltZXJhIGxldHJhIGRlIHVuYSBjYWRlbmFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjYXBpdGFsaXplKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb252aWVydGUgdGV4dG8gYSBzbHVnIChVUkwtZnJpZW5kbHkpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2x1Z2lmeSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiB0ZXh0XHJcbiAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgLm5vcm1hbGl6ZSgnTkZEJylcclxuICAgIC5yZXBsYWNlKC9bXFx1MDMwMC1cXHUwMzZmXS9nLCAnJykgLy8gUmVtb3ZlIGFjY2VudHNcclxuICAgIC5yZXBsYWNlKC9bXmEtejAtOVxccy1dL2csICcnKSAvLyBSZW1vdmUgc3BlY2lhbCBjaGFyc1xyXG4gICAgLnJlcGxhY2UoL1xccysvZywgJy0nKSAvLyBSZXBsYWNlIHNwYWNlcyB3aXRoIGh5cGhlbnNcclxuICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpIC8vIFJlcGxhY2UgbXVsdGlwbGUgaHlwaGVucyB3aXRoIHNpbmdsZVxyXG4gICAgLnRyaW0oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRydW5jYSB0ZXh0byBjb24gZWxpcHNpc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRydW5jYXRlKHRleHQ6IHN0cmluZywgbGVuZ3RoOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gIGlmICh0ZXh0Lmxlbmd0aCA8PSBsZW5ndGgpIHJldHVybiB0ZXh0O1xyXG4gIHJldHVybiB0ZXh0LnNsaWNlKDAsIGxlbmd0aCkgKyAnLi4uJztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9idGllbmUgaW5pY2lhbGVzIGRlIHVuIG5vbWJyZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEluaXRpYWxzKGZpcnN0TmFtZT86IHN0cmluZyB8IG51bGwsIGxhc3ROYW1lPzogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB7XHJcbiAgY29uc3QgZmlyc3QgPSBmaXJzdE5hbWU/LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpIHx8ICcnO1xyXG4gIGNvbnN0IGxhc3QgPSBsYXN0TmFtZT8uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgfHwgJyc7XHJcbiAgcmV0dXJuIChmaXJzdCArIGxhc3QpIHx8ICc/JztcclxufVxyXG5cclxuLyoqXHJcbiAqIEZvcm1hdGVhIG5vbWJyZSBjb21wbGV0b1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEZ1bGxOYW1lKGZpcnN0TmFtZT86IHN0cmluZyB8IG51bGwsIGxhc3ROYW1lPzogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB7XHJcbiAgY29uc3QgcGFydHMgPSBbZmlyc3ROYW1lLCBsYXN0TmFtZV0uZmlsdGVyKEJvb2xlYW4pO1xyXG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPiAwID8gcGFydHMuam9pbignICcpIDogJ1VzdWFyaW8nO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJREFERVMgREUgQVJSQVlTIFkgT0JKRVRPU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogQWdydXBhIGFycmF5IHBvciB1bmEgcHJvcGllZGFkXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBCeTxULCBLIGV4dGVuZHMga2V5b2YgVD4oYXJyYXk6IFRbXSwga2V5OiBLKTogUmVjb3JkPHN0cmluZywgVFtdPiB7XHJcbiAgcmV0dXJuIGFycmF5LnJlZHVjZSgoZ3JvdXBzLCBpdGVtKSA9PiB7XHJcbiAgICBjb25zdCBncm91cCA9IFN0cmluZyhpdGVtW2tleV0pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgLi4uZ3JvdXBzLFxyXG4gICAgICBbZ3JvdXBdOiBbLi4uKGdyb3Vwc1tncm91cF0gfHwgW10pLCBpdGVtXVxyXG4gICAgfTtcclxuICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBUW10+KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE9yZGVuYSBhcnJheSBwb3IgdW5hIHByb3BpZWRhZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRCeTxUPihhcnJheTogVFtdLCBrZXk6IGtleW9mIFQsIGRpcmVjdGlvbjogJ2FzYycgfCAnZGVzYycgPSAnYXNjJyk6IFRbXSB7XHJcbiAgcmV0dXJuIFsuLi5hcnJheV0uc29ydCgoYSwgYikgPT4ge1xyXG4gICAgY29uc3QgYVZhbHVlID0gYVtrZXldO1xyXG4gICAgY29uc3QgYlZhbHVlID0gYltrZXldO1xyXG4gICAgXHJcbiAgICBpZiAoYVZhbHVlIDwgYlZhbHVlKSByZXR1cm4gZGlyZWN0aW9uID09PSAnYXNjJyA/IC0xIDogMTtcclxuICAgIGlmIChhVmFsdWUgPiBiVmFsdWUpIHJldHVybiBkaXJlY3Rpb24gPT09ICdhc2MnID8gMSA6IC0xO1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGaWx0cmEgdmFsb3JlcyDDum5pY29zIGRlIHVuIGFycmF5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5pcXVlPFQ+KGFycmF5OiBUW10pOiBUW10ge1xyXG4gIHJldHVybiBbLi4ubmV3IFNldChhcnJheSldO1xyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFVUSUxJREFERVMgREUgUFJPTU9DSU9ORVNcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyoqXHJcbiAqIEZvcm1hdGVhIGVsIGRlc2N1ZW50byBkZSB1biBjw7NkaWdvIHByb21vY2lvbmFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGlzY291bnQodHlwZTogc3RyaW5nLCB2YWx1ZTogbnVtYmVyKTogc3RyaW5nIHtcclxuICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgIGNhc2UgXCJQRVJDRU5UQUdFXCI6XHJcbiAgICAgIHJldHVybiBgJHt2YWx1ZX0lYDtcclxuICAgIGNhc2UgXCJGSVhFRF9BTU9VTlRcIjpcclxuICAgICAgcmV0dXJuIGZvcm1hdEN1cnJlbmN5KHZhbHVlKTtcclxuICAgIGNhc2UgXCJGUkVFXCI6XHJcbiAgICAgIHJldHVybiBcIkdyYXRpc1wiO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2FsY3VsYSBlbCBwb3JjZW50YWplIGRlIHVzbyBkZSB1biBjw7NkaWdvIHByb21vY2lvbmFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlVXNhZ2VQZXJjZW50YWdlKHVzZWQ6IG51bWJlciwgbGltaXQ/OiBudW1iZXIpOiBudW1iZXIge1xyXG4gIGlmICghbGltaXQpIHJldHVybiAwO1xyXG4gIHJldHVybiBNYXRoLm1pbigodXNlZCAvIGxpbWl0KSAqIDEwMCwgMTAwKTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBVVElMSURBREVTIERFIEVTVEFET1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogT2J0aWVuZSBsYSBjb25maWd1cmFjacOzbiBkZSBjb2xvciBwYXJhIHVuIGVzdGFkb1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0YXR1c0NvbmZpZyhzdGF0dXM6IHN0cmluZyk6IHtcclxuICBsYWJlbDogc3RyaW5nO1xyXG4gIGNvbG9yOiBzdHJpbmc7XHJcbiAgdmFyaWFudDogXCJkZWZhdWx0XCIgfCBcInNlY29uZGFyeVwiIHwgXCJkZXN0cnVjdGl2ZVwiIHwgXCJvdXRsaW5lXCI7XHJcbn0ge1xyXG4gIGNvbnN0IGNvbmZpZ3MgPSB7XHJcbiAgICBBQ1RJVkU6IHsgbGFiZWw6IFwiQWN0aXZvXCIsIGNvbG9yOiBcImJnLWdyZWVuLTEwMCB0ZXh0LWdyZWVuLTgwMFwiLCB2YXJpYW50OiBcImRlZmF1bHRcIiBhcyBjb25zdCB9LFxyXG4gICAgSU5BQ1RJVkU6IHsgbGFiZWw6IFwiSW5hY3Rpdm9cIiwgY29sb3I6IFwiYmctZ3JheS0xMDAgdGV4dC1ncmF5LTgwMFwiLCB2YXJpYW50OiBcInNlY29uZGFyeVwiIGFzIGNvbnN0IH0sXHJcbiAgICBFWFBJUkVEOiB7IGxhYmVsOiBcIkV4cGlyYWRvXCIsIGNvbG9yOiBcImJnLXJlZC0xMDAgdGV4dC1yZWQtODAwXCIsIHZhcmlhbnQ6IFwiZGVzdHJ1Y3RpdmVcIiBhcyBjb25zdCB9LFxyXG4gICAgVVNFRF9VUDogeyBsYWJlbDogXCJBZ290YWRvXCIsIGNvbG9yOiBcImJnLW9yYW5nZS0xMDAgdGV4dC1vcmFuZ2UtODAwXCIsIHZhcmlhbnQ6IFwib3V0bGluZVwiIGFzIGNvbnN0IH0sXHJcbiAgICBQRU5ESU5HOiB7IGxhYmVsOiBcIlBlbmRpZW50ZVwiLCBjb2xvcjogXCJiZy15ZWxsb3ctMTAwIHRleHQteWVsbG93LTgwMFwiLCB2YXJpYW50OiBcIm91dGxpbmVcIiBhcyBjb25zdCB9LFxyXG4gICAgUEFJRDogeyBsYWJlbDogXCJQYWdhZG9cIiwgY29sb3I6IFwiYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwXCIsIHZhcmlhbnQ6IFwiZGVmYXVsdFwiIGFzIGNvbnN0IH0sXHJcbiAgICBGQUlMRUQ6IHsgbGFiZWw6IFwiRmFsbGlkb1wiLCBjb2xvcjogXCJiZy1yZWQtMTAwIHRleHQtcmVkLTgwMFwiLCB2YXJpYW50OiBcImRlc3RydWN0aXZlXCIgYXMgY29uc3QgfSxcclxuICAgIENBTkNFTExFRDogeyBsYWJlbDogXCJDYW5jZWxhZG9cIiwgY29sb3I6IFwiYmctZ3JheS0xMDAgdGV4dC1ncmF5LTgwMFwiLCB2YXJpYW50OiBcInNlY29uZGFyeVwiIGFzIGNvbnN0IH0sXHJcbiAgICBSRUZVTkRFRDogeyBsYWJlbDogXCJSZWVtYm9sc2Fkb1wiLCBjb2xvcjogXCJiZy1ibHVlLTEwMCB0ZXh0LWJsdWUtODAwXCIsIHZhcmlhbnQ6IFwib3V0bGluZVwiIGFzIGNvbnN0IH0sXHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIGNvbmZpZ3Nbc3RhdHVzIGFzIGtleW9mIHR5cGVvZiBjb25maWdzXSB8fCB7XHJcbiAgICBsYWJlbDogc3RhdHVzLFxyXG4gICAgY29sb3I6IFwiYmctZ3JheS0xMDAgdGV4dC1ncmF5LTgwMFwiLFxyXG4gICAgdmFyaWFudDogXCJzZWNvbmRhcnlcIiBhcyBjb25zdFxyXG4gIH07XHJcbn1cclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVVRJTElEQURFUyBERSBERUJPVU5DRVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vKipcclxuICogRnVuY2nDs24gZGUgZGVib3VuY2UgcGFyYSBvcHRpbWl6YXIgYsO6c3F1ZWRhc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlPFQgZXh0ZW5kcyAoLi4uYXJnczogdW5rbm93bltdKSA9PiB1bmtub3duPihcclxuICBmdW5jOiBULFxyXG4gIHdhaXQ6IG51bWJlclxyXG4pOiAoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4gdm9pZCB7XHJcbiAgbGV0IHRpbWVvdXQ6IE5vZGVKUy5UaW1lb3V0O1xyXG4gIFxyXG4gIHJldHVybiAoLi4uYXJnczogUGFyYW1ldGVyczxUPikgPT4ge1xyXG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG4gICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gZnVuYyguLi5hcmdzKSwgd2FpdCk7XHJcbiAgfTtcclxufVxyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBVVElMSURBREVTIERFIEFSQ0hJVk9TXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBDb252aWVydGUgYnl0ZXMgYSBmb3JtYXRvIGxlZ2libGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRGaWxlU2l6ZShieXRlczogbnVtYmVyKTogc3RyaW5nIHtcclxuICBpZiAoYnl0ZXMgPT09IDApIHJldHVybiAnMCBCeXRlcyc7XHJcbiAgXHJcbiAgY29uc3QgayA9IDEwMjQ7XHJcbiAgY29uc3Qgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJ107XHJcbiAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpO1xyXG4gIFxyXG4gIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhIHRpcG8gZGUgYXJjaGl2byBwb3IgZXh0ZW5zacOzblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRJbWFnZUZpbGUoZmlsZW5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHZhbGlkRXh0ZW5zaW9ucyA9IFsnLmpwZycsICcuanBlZycsICcucG5nJywgJy5naWYnLCAnLndlYnAnXTtcclxuICBjb25zdCBleHRlbnNpb24gPSBmaWxlbmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZyhmaWxlbmFtZS5sYXN0SW5kZXhPZignLicpKTtcclxuICByZXR1cm4gdmFsaWRFeHRlbnNpb25zLmluY2x1ZGVzKGV4dGVuc2lvbik7XHJcbn1cclxuIl0sInZlcnNpb24iOjN9