dc0d497dca4e0105840dd89362040ca3
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cn = cn;
exports.formatCurrency = formatCurrency;
exports.formatPriceRange = formatPriceRange;
exports.formatNumber = formatNumber;
exports.formatPercentage = formatPercentage;
exports.formatDisplayDate = formatDisplayDate;
exports.formatDisplayDateTime = formatDisplayDateTime;
exports.formatTime = formatTime;
exports.formatShortDate = formatShortDate;
exports.getRelativeDateDescription = getRelativeDateDescription;
exports.isFutureDate = isFutureDate;
exports.isValidEmail = isValidEmail;
exports.isValidUrl = isValidUrl;
exports.capitalize = capitalize;
exports.slugify = slugify;
exports.truncate = truncate;
exports.getInitials = getInitials;
exports.formatFullName = formatFullName;
exports.groupBy = groupBy;
exports.sortBy = sortBy;
exports.unique = unique;
exports.formatDiscount = formatDiscount;
exports.calculateUsagePercentage = calculateUsagePercentage;
exports.getStatusConfig = getStatusConfig;
exports.debounce = debounce;
exports.formatFileSize = formatFileSize;
exports.isValidImageFile = isValidImageFile;
const clsx_1 = require("clsx");
const tailwind_merge_1 = require("tailwind-merge");
function cn(...inputs) {
    return (0, tailwind_merge_1.twMerge)((0, clsx_1.clsx)(inputs));
}
function formatCurrency(amount, currency = 'CLP') {
    if (amount === 0)
        return 'Gratis';
    return new Intl.NumberFormat('es-CL', {
        style: 'currency',
        currency: currency,
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
    }).format(amount);
}
function formatPriceRange(min, max, currency = 'CLP') {
    if (min === 0 && max === 0)
        return "Gratis";
    if (min === max)
        return formatCurrency(min, currency);
    return `Desde ${formatCurrency(min, currency)}`;
}
function formatNumber(num) {
    if (num >= 1000000000) {
        return (num / 1000000000).toFixed(1) + 'B';
    }
    if (num >= 1000000) {
        return (num / 1000000).toFixed(1) + 'M';
    }
    if (num >= 1000) {
        return (num / 1000).toFixed(1) + 'K';
    }
    return num.toString();
}
function formatPercentage(value, decimals = 1) {
    return `${value.toFixed(decimals)}%`;
}
function formatDisplayDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleDateString("es-CL", {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
        timeZone: "America/Santiago",
    });
}
function formatDisplayDateTime(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleString("es-CL", {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
        timeZone: "America/Santiago",
    });
}
function formatTime(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleTimeString("es-CL", {
        hour: "2-digit",
        minute: "2-digit",
        timeZone: "America/Santiago",
    });
}
function formatShortDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj.toLocaleDateString("es-CL", {
        day: "2-digit",
        month: "2-digit",
        year: "numeric",
        timeZone: "America/Santiago",
    });
}
function getRelativeDateDescription(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    const now = new Date();
    if (dateObj.toDateString() === now.toDateString())
        return "Hoy";
    const tomorrow = new Date(now);
    tomorrow.setDate(tomorrow.getDate() + 1);
    if (dateObj.toDateString() === tomorrow.toDateString())
        return "Mañana";
    const diffTime = dateObj.getTime() - now.getTime();
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    if (diffDays < 0) {
        return diffDays === -1 ? "Ayer" : `Hace ${Math.abs(diffDays)} días`;
    }
    else if (diffDays <= 7) {
        return `En ${diffDays} días`;
    }
    else {
        return formatDisplayDate(dateObj);
    }
}
function isFutureDate(date) {
    const dateObj = typeof date === 'string' ? new Date(date) : date;
    return dateObj > new Date();
}
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}
function isValidUrl(url) {
    try {
        new URL(url);
        return true;
    }
    catch (_a) {
        return false;
    }
}
function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
}
function slugify(text) {
    return text
        .toLowerCase()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '')
        .replace(/[^a-z0-9\s-]/g, '')
        .replace(/\s+/g, '-')
        .replace(/-+/g, '-')
        .trim();
}
function truncate(text, length) {
    if (text.length <= length)
        return text;
    return text.slice(0, length) + '...';
}
function getInitials(firstName, lastName) {
    const first = (firstName === null || firstName === void 0 ? void 0 : firstName.charAt(0).toUpperCase()) || '';
    const last = (lastName === null || lastName === void 0 ? void 0 : lastName.charAt(0).toUpperCase()) || '';
    return (first + last) || '?';
}
function formatFullName(firstName, lastName) {
    const parts = [firstName, lastName].filter(Boolean);
    return parts.length > 0 ? parts.join(' ') : 'Usuario';
}
function groupBy(array, key) {
    return array.reduce((groups, item) => {
        const group = String(item[key]);
        return Object.assign(Object.assign({}, groups), { [group]: [...(groups[group] || []), item] });
    }, {});
}
function sortBy(array, key, direction = 'asc') {
    return [...array].sort((a, b) => {
        const aValue = a[key];
        const bValue = b[key];
        if (aValue < bValue)
            return direction === 'asc' ? -1 : 1;
        if (aValue > bValue)
            return direction === 'asc' ? 1 : -1;
        return 0;
    });
}
function unique(array) {
    return [...new Set(array)];
}
function formatDiscount(type, value) {
    switch (type) {
        case "PERCENTAGE":
            return `${value}%`;
        case "FIXED_AMOUNT":
            return formatCurrency(value);
        case "FREE":
            return "Gratis";
        default:
            return value.toString();
    }
}
function calculateUsagePercentage(used, limit) {
    if (!limit)
        return 0;
    return Math.min((used / limit) * 100, 100);
}
function getStatusConfig(status) {
    const configs = {
        ACTIVE: { label: "Activo", color: "bg-green-100 text-green-800", variant: "default" },
        INACTIVE: { label: "Inactivo", color: "bg-gray-100 text-gray-800", variant: "secondary" },
        EXPIRED: { label: "Expirado", color: "bg-red-100 text-red-800", variant: "destructive" },
        USED_UP: { label: "Agotado", color: "bg-orange-100 text-orange-800", variant: "outline" },
        PENDING: { label: "Pendiente", color: "bg-yellow-100 text-yellow-800", variant: "outline" },
        PAID: { label: "Pagado", color: "bg-green-100 text-green-800", variant: "default" },
        FAILED: { label: "Fallido", color: "bg-red-100 text-red-800", variant: "destructive" },
        CANCELLED: { label: "Cancelado", color: "bg-gray-100 text-gray-800", variant: "secondary" },
        REFUNDED: { label: "Reembolsado", color: "bg-blue-100 text-blue-800", variant: "outline" },
    };
    return configs[status] || {
        label: status,
        color: "bg-gray-100 text-gray-800",
        variant: "secondary"
    };
}
function debounce(func, wait) {
    let timeout;
    return (...args) => {
        clearTimeout(timeout);
        timeout = setTimeout(() => func(...args), wait);
    };
}
function formatFileSize(bytes) {
    if (bytes === 0)
        return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}
function isValidImageFile(filename) {
    const validExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp'];
    const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));
    return validExtensions.includes(extension);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxCaWx1clxcRG9jdW1lbnRzXFxEZXZlbG9wbWVudFxcTmV4dFxcc29yeWNrLWFjY2Vzc1xcc3JjXFxsaWJcXHV0aWxzLnRzIiwibWFwcGluZ3MiOiI7O0FBU0EsZ0JBRUM7QUFPRCx3Q0FZQztBQUdELDRDQVFDO0FBR0Qsb0NBV0M7QUFHRCw0Q0FFQztBQU9ELDhDQVVDO0FBR0Qsc0RBWUM7QUFHRCxnQ0FRQztBQUdELDBDQVNDO0FBR0QsZ0VBdUJDO0FBT0Qsb0NBR0M7QUFHRCxvQ0FHQztBQUdELGdDQU9DO0FBT0QsZ0NBRUM7QUFHRCwwQkFTQztBQUdELDRCQUdDO0FBR0Qsa0NBSUM7QUFHRCx3Q0FHQztBQU9ELDBCQVFDO0FBR0Qsd0JBU0M7QUFHRCx3QkFFQztBQU9ELHdDQVdDO0FBR0QsNERBR0M7QUFPRCwwQ0FzQkM7QUFPRCw0QkFVQztBQU9ELHdDQVFDO0FBR0QsNENBSUM7QUF6VUQsK0JBQTZDO0FBQzdDLG1EQUF5QztBQU16QyxTQUFnQixFQUFFLENBQUMsR0FBRyxNQUFvQjtJQUN4QyxPQUFPLElBQUEsd0JBQU8sRUFBQyxJQUFBLFdBQUksRUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0FBQy9CLENBQUM7QUFPRCxTQUFnQixjQUFjLENBQzVCLE1BQWMsRUFDZCxXQUFtQixLQUFLO0lBRXhCLElBQUksTUFBTSxLQUFLLENBQUM7UUFBRSxPQUFPLFFBQVEsQ0FBQztJQUVsQyxPQUFPLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUU7UUFDcEMsS0FBSyxFQUFFLFVBQVU7UUFDakIsUUFBUSxFQUFFLFFBQVE7UUFDbEIscUJBQXFCLEVBQUUsQ0FBQztRQUN4QixxQkFBcUIsRUFBRSxDQUFDO0tBQ3pCLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDcEIsQ0FBQztBQUdELFNBQWdCLGdCQUFnQixDQUM5QixHQUFXLEVBQ1gsR0FBVyxFQUNYLFdBQW1CLEtBQUs7SUFFeEIsSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLEdB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SUFFcEQsT0FBTyxVQUFVLENBQUMsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzFFLENBQUM7QUFHRCxTQUFnQixnQkFBZ0IsQ0FBQyxRQUFnQjtJQUMvQyxNQUFNLGVBQWUsR0FBRyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUNuRSxNQUFNLFNBQVMsR0FBRyxRQUFRLENBQUMsV0FBVyxFQUFFLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM5RSxPQUFPLGVBQWUsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDN0MsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXEJpbHVyXFxEb2N1bWVudHNcXERldmVsb3BtZW50XFxOZXh0XFxzb3J5Y2stYWNjZXNzXFxzcmNcXGxpYlxcdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXHJcblxyXG5pbXBvcnQgeyB0eXBlIENsYXNzVmFsdWUsIGNsc3ggfSBmcm9tIFwiY2xzeFwiO1xyXG5pbXBvcnQgeyB0d01lcmdlIH0gZnJvbSBcInRhaWx3aW5kLW1lcmdlXCI7XHJcblxyXG5cclxuXHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNuKC4uLmlucHV0czogQ2xhc3NWYWx1ZVtdKSB7XHJcbiAgcmV0dXJuIHR3TWVyZ2UoY2xzeChpbnB1dHMpKTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0Q3VycmVuY3koXHJcbiAgYW1vdW50OiBudW1iZXIsIFxyXG4gIGN1cnJlbmN5OiBzdHJpbmcgPSAnQ0xQJ1xyXG4pOiBzdHJpbmcge1xyXG4gIGlmIChhbW91bnQgPT09IDApIHJldHVybiAnR3JhdGlzJztcclxuICBcclxuICByZXR1cm4gbmV3IEludGwuTnVtYmVyRm9ybWF0KCdlcy1DTCcsIHtcclxuICAgIHN0eWxlOiAnY3VycmVuY3knLFxyXG4gICAgY3VycmVuY3k6IGN1cnJlbmN5LFxyXG4gICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAwLFxyXG4gICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAwXHJcbiAgfSkuZm9ybWF0KGFtb3VudCk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0UHJpY2VSYW5nZShcclxuICBtaW46IG51bWJlciwgXHJcbiAgbWF4OiBudW1iZXIsIFxyXG4gIGN1cnJlbmN5OiBzdHJpbmcgPSAnQ0xQJ1xyXG4pOiBzdHJpbmcge1xyXG4gIGlmIChtaW4gPT09IDAgJiYgbWF4ID09PSAwKSByZXR1cm4gXCJHcmF0aXNcIjtcclxuICBpZiAobWluID09PSBtYXgpIHJldHVybiBmb3JtYXRDdXJyZW5jeShtaW4sIGN1cnJlbmN5KTtcclxuICByZXR1cm4gYERlc2RlICR7Zm9ybWF0Q3VycmVuY3kobWluLCBjdXJyZW5jeSl9YDtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gIGlmIChudW0gPj0gMTAwMDAwMDAwMCkge1xyXG4gICAgcmV0dXJuIChudW0gLyAxMDAwMDAwMDAwKS50b0ZpeGVkKDEpICsgJ0InO1xyXG4gIH1cclxuICBpZiAobnVtID49IDEwMDAwMDApIHtcclxuICAgIHJldHVybiAobnVtIC8gMTAwMDAwMCkudG9GaXhlZCgxKSArICdNJztcclxuICB9XHJcbiAgaWYgKG51bSA+PSAxMDAwKSB7XHJcbiAgICByZXR1cm4gKG51bSAvIDEwMDApLnRvRml4ZWQoMSkgKyAnSyc7XHJcbiAgfVxyXG4gIHJldHVybiBudW0udG9TdHJpbmcoKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRQZXJjZW50YWdlKHZhbHVlOiBudW1iZXIsIGRlY2ltYWxzOiBudW1iZXIgPSAxKTogc3RyaW5nIHtcclxuICByZXR1cm4gYCR7dmFsdWUudG9GaXhlZChkZWNpbWFscyl9JWA7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERpc3BsYXlEYXRlKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRhdGVPYmogPSB0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycgPyBuZXcgRGF0ZShkYXRlKSA6IGRhdGU7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGVPYmoudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZXMtQ0xcIiwge1xyXG4gICAgd2Vla2RheTogXCJsb25nXCIsXHJcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcclxuICAgIG1vbnRoOiBcImxvbmdcIixcclxuICAgIGRheTogXCJudW1lcmljXCIsXHJcbiAgICB0aW1lWm9uZTogXCJBbWVyaWNhL1NhbnRpYWdvXCIsXHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGlzcGxheURhdGVUaW1lKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRhdGVPYmogPSB0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycgPyBuZXcgRGF0ZShkYXRlKSA6IGRhdGU7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGVPYmoudG9Mb2NhbGVTdHJpbmcoXCJlcy1DTFwiLCB7XHJcbiAgICB3ZWVrZGF5OiBcImxvbmdcIixcclxuICAgIHllYXI6IFwibnVtZXJpY1wiLFxyXG4gICAgbW9udGg6IFwibG9uZ1wiLFxyXG4gICAgZGF5OiBcIm51bWVyaWNcIixcclxuICAgIGhvdXI6IFwiMi1kaWdpdFwiLFxyXG4gICAgbWludXRlOiBcIjItZGlnaXRcIixcclxuICAgIHRpbWVab25lOiBcIkFtZXJpY2EvU2FudGlhZ29cIixcclxuICB9KTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRUaW1lKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRhdGVPYmogPSB0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycgPyBuZXcgRGF0ZShkYXRlKSA6IGRhdGU7XHJcbiAgXHJcbiAgcmV0dXJuIGRhdGVPYmoudG9Mb2NhbGVUaW1lU3RyaW5nKFwiZXMtQ0xcIiwge1xyXG4gICAgaG91cjogXCIyLWRpZ2l0XCIsXHJcbiAgICBtaW51dGU6IFwiMi1kaWdpdFwiLFxyXG4gICAgdGltZVpvbmU6IFwiQW1lcmljYS9TYW50aWFnb1wiLFxyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFNob3J0RGF0ZShkYXRlOiBEYXRlIHwgc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIFxyXG4gIHJldHVybiBkYXRlT2JqLnRvTG9jYWxlRGF0ZVN0cmluZyhcImVzLUNMXCIsIHtcclxuICAgIGRheTogXCIyLWRpZ2l0XCIsXHJcbiAgICBtb250aDogXCIyLWRpZ2l0XCIsXHJcbiAgICB5ZWFyOiBcIm51bWVyaWNcIixcclxuICAgIHRpbWVab25lOiBcIkFtZXJpY2EvU2FudGlhZ29cIixcclxuICB9KTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWxhdGl2ZURhdGVEZXNjcmlwdGlvbihkYXRlOiBEYXRlIHwgc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgXHJcbiAgXHJcbiAgaWYgKGRhdGVPYmoudG9EYXRlU3RyaW5nKCkgPT09IG5vdy50b0RhdGVTdHJpbmcoKSkgcmV0dXJuIFwiSG95XCI7XHJcbiAgXHJcbiAgXHJcbiAgY29uc3QgdG9tb3Jyb3cgPSBuZXcgRGF0ZShub3cpO1xyXG4gIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpICsgMSk7XHJcbiAgaWYgKGRhdGVPYmoudG9EYXRlU3RyaW5nKCkgPT09IHRvbW9ycm93LnRvRGF0ZVN0cmluZygpKSByZXR1cm4gXCJNYcOxYW5hXCI7XHJcbiAgXHJcbiAgXHJcbiAgY29uc3QgZGlmZlRpbWUgPSBkYXRlT2JqLmdldFRpbWUoKSAtIG5vdy5nZXRUaW1lKCk7XHJcbiAgY29uc3QgZGlmZkRheXMgPSBNYXRoLmNlaWwoZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xyXG4gIFxyXG4gIGlmIChkaWZmRGF5cyA8IDApIHtcclxuICAgIHJldHVybiBkaWZmRGF5cyA9PT0gLTEgPyBcIkF5ZXJcIiA6IGBIYWNlICR7TWF0aC5hYnMoZGlmZkRheXMpfSBkw61hc2A7XHJcbiAgfSBlbHNlIGlmIChkaWZmRGF5cyA8PSA3KSB7XHJcbiAgICByZXR1cm4gYEVuICR7ZGlmZkRheXN9IGTDrWFzYDtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGZvcm1hdERpc3BsYXlEYXRlKGRhdGVPYmopO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNGdXR1cmVEYXRlKGRhdGU6IERhdGUgfCBzdHJpbmcpOiBib29sZWFuIHtcclxuICBjb25zdCBkYXRlT2JqID0gdHlwZW9mIGRhdGUgPT09ICdzdHJpbmcnID8gbmV3IERhdGUoZGF0ZSkgOiBkYXRlO1xyXG4gIHJldHVybiBkYXRlT2JqID4gbmV3IERhdGUoKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkRW1haWwoZW1haWw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IGVtYWlsUmVnZXggPSAvXlteXFxzQF0rQFteXFxzQF0rXFwuW15cXHNAXSskLztcclxuICByZXR1cm4gZW1haWxSZWdleC50ZXN0KGVtYWlsKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgdHJ5IHtcclxuICAgIG5ldyBVUkwodXJsKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKS50b0xvd2VyQ2FzZSgpO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNsdWdpZnkodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gdGV4dFxyXG4gICAgLnRvTG93ZXJDYXNlKClcclxuICAgIC5ub3JtYWxpemUoJ05GRCcpXHJcbiAgICAucmVwbGFjZSgvW1xcdTAzMDAtXFx1MDM2Zl0vZywgJycpIFxyXG4gICAgLnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgJycpIFxyXG4gICAgLnJlcGxhY2UoL1xccysvZywgJy0nKSBcclxuICAgIC5yZXBsYWNlKC8tKy9nLCAnLScpIFxyXG4gICAgLnRyaW0oKTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZSh0ZXh0OiBzdHJpbmcsIGxlbmd0aDogbnVtYmVyKTogc3RyaW5nIHtcclxuICBpZiAodGV4dC5sZW5ndGggPD0gbGVuZ3RoKSByZXR1cm4gdGV4dDtcclxuICByZXR1cm4gdGV4dC5zbGljZSgwLCBsZW5ndGgpICsgJy4uLic7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SW5pdGlhbHMoZmlyc3ROYW1lPzogc3RyaW5nIHwgbnVsbCwgbGFzdE5hbWU/OiBzdHJpbmcgfCBudWxsKTogc3RyaW5nIHtcclxuICBjb25zdCBmaXJzdCA9IGZpcnN0TmFtZT8uY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgfHwgJyc7XHJcbiAgY29uc3QgbGFzdCA9IGxhc3ROYW1lPy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSB8fCAnJztcclxuICByZXR1cm4gKGZpcnN0ICsgbGFzdCkgfHwgJz8nO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEZ1bGxOYW1lKGZpcnN0TmFtZT86IHN0cmluZyB8IG51bGwsIGxhc3ROYW1lPzogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB7XHJcbiAgY29uc3QgcGFydHMgPSBbZmlyc3ROYW1lLCBsYXN0TmFtZV0uZmlsdGVyKEJvb2xlYW4pO1xyXG4gIHJldHVybiBwYXJ0cy5sZW5ndGggPiAwID8gcGFydHMuam9pbignICcpIDogJ1VzdWFyaW8nO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBncm91cEJ5PFQsIEsgZXh0ZW5kcyBrZXlvZiBUPihhcnJheTogVFtdLCBrZXk6IEspOiBSZWNvcmQ8c3RyaW5nLCBUW10+IHtcclxuICByZXR1cm4gYXJyYXkucmVkdWNlKChncm91cHMsIGl0ZW0pID0+IHtcclxuICAgIGNvbnN0IGdyb3VwID0gU3RyaW5nKGl0ZW1ba2V5XSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5ncm91cHMsXHJcbiAgICAgIFtncm91cF06IFsuLi4oZ3JvdXBzW2dyb3VwXSB8fCBbXSksIGl0ZW1dXHJcbiAgICB9O1xyXG4gIH0sIHt9IGFzIFJlY29yZDxzdHJpbmcsIFRbXT4pO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRCeTxUPihhcnJheTogVFtdLCBrZXk6IGtleW9mIFQsIGRpcmVjdGlvbjogJ2FzYycgfCAnZGVzYycgPSAnYXNjJyk6IFRbXSB7XHJcbiAgcmV0dXJuIFsuLi5hcnJheV0uc29ydCgoYSwgYikgPT4ge1xyXG4gICAgY29uc3QgYVZhbHVlID0gYVtrZXldO1xyXG4gICAgY29uc3QgYlZhbHVlID0gYltrZXldO1xyXG4gICAgXHJcbiAgICBpZiAoYVZhbHVlIDwgYlZhbHVlKSByZXR1cm4gZGlyZWN0aW9uID09PSAnYXNjJyA/IC0xIDogMTtcclxuICAgIGlmIChhVmFsdWUgPiBiVmFsdWUpIHJldHVybiBkaXJlY3Rpb24gPT09ICdhc2MnID8gMSA6IC0xO1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdW5pcXVlPFQ+KGFycmF5OiBUW10pOiBUW10ge1xyXG4gIHJldHVybiBbLi4ubmV3IFNldChhcnJheSldO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXREaXNjb3VudCh0eXBlOiBzdHJpbmcsIHZhbHVlOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gIHN3aXRjaCAodHlwZSkge1xyXG4gICAgY2FzZSBcIlBFUkNFTlRBR0VcIjpcclxuICAgICAgcmV0dXJuIGAke3ZhbHVlfSVgO1xyXG4gICAgY2FzZSBcIkZJWEVEX0FNT1VOVFwiOlxyXG4gICAgICByZXR1cm4gZm9ybWF0Q3VycmVuY3kodmFsdWUpO1xyXG4gICAgY2FzZSBcIkZSRUVcIjpcclxuICAgICAgcmV0dXJuIFwiR3JhdGlzXCI7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlVXNhZ2VQZXJjZW50YWdlKHVzZWQ6IG51bWJlciwgbGltaXQ/OiBudW1iZXIpOiBudW1iZXIge1xyXG4gIGlmICghbGltaXQpIHJldHVybiAwO1xyXG4gIHJldHVybiBNYXRoLm1pbigodXNlZCAvIGxpbWl0KSAqIDEwMCwgMTAwKTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RhdHVzQ29uZmlnKHN0YXR1czogc3RyaW5nKToge1xyXG4gIGxhYmVsOiBzdHJpbmc7XHJcbiAgY29sb3I6IHN0cmluZztcclxuICB2YXJpYW50OiBcImRlZmF1bHRcIiB8IFwic2Vjb25kYXJ5XCIgfCBcImRlc3RydWN0aXZlXCIgfCBcIm91dGxpbmVcIjtcclxufSB7XHJcbiAgY29uc3QgY29uZmlncyA9IHtcclxuICAgIEFDVElWRTogeyBsYWJlbDogXCJBY3Rpdm9cIiwgY29sb3I6IFwiYmctZ3JlZW4tMTAwIHRleHQtZ3JlZW4tODAwXCIsIHZhcmlhbnQ6IFwiZGVmYXVsdFwiIGFzIGNvbnN0IH0sXHJcbiAgICBJTkFDVElWRTogeyBsYWJlbDogXCJJbmFjdGl2b1wiLCBjb2xvcjogXCJiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwXCIsIHZhcmlhbnQ6IFwic2Vjb25kYXJ5XCIgYXMgY29uc3QgfSxcclxuICAgIEVYUElSRUQ6IHsgbGFiZWw6IFwiRXhwaXJhZG9cIiwgY29sb3I6IFwiYmctcmVkLTEwMCB0ZXh0LXJlZC04MDBcIiwgdmFyaWFudDogXCJkZXN0cnVjdGl2ZVwiIGFzIGNvbnN0IH0sXHJcbiAgICBVU0VEX1VQOiB7IGxhYmVsOiBcIkFnb3RhZG9cIiwgY29sb3I6IFwiYmctb3JhbmdlLTEwMCB0ZXh0LW9yYW5nZS04MDBcIiwgdmFyaWFudDogXCJvdXRsaW5lXCIgYXMgY29uc3QgfSxcclxuICAgIFBFTkRJTkc6IHsgbGFiZWw6IFwiUGVuZGllbnRlXCIsIGNvbG9yOiBcImJnLXllbGxvdy0xMDAgdGV4dC15ZWxsb3ctODAwXCIsIHZhcmlhbnQ6IFwib3V0bGluZVwiIGFzIGNvbnN0IH0sXHJcbiAgICBQQUlEOiB7IGxhYmVsOiBcIlBhZ2Fkb1wiLCBjb2xvcjogXCJiZy1ncmVlbi0xMDAgdGV4dC1ncmVlbi04MDBcIiwgdmFyaWFudDogXCJkZWZhdWx0XCIgYXMgY29uc3QgfSxcclxuICAgIEZBSUxFRDogeyBsYWJlbDogXCJGYWxsaWRvXCIsIGNvbG9yOiBcImJnLXJlZC0xMDAgdGV4dC1yZWQtODAwXCIsIHZhcmlhbnQ6IFwiZGVzdHJ1Y3RpdmVcIiBhcyBjb25zdCB9LFxyXG4gICAgQ0FOQ0VMTEVEOiB7IGxhYmVsOiBcIkNhbmNlbGFkb1wiLCBjb2xvcjogXCJiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwXCIsIHZhcmlhbnQ6IFwic2Vjb25kYXJ5XCIgYXMgY29uc3QgfSxcclxuICAgIFJFRlVOREVEOiB7IGxhYmVsOiBcIlJlZW1ib2xzYWRvXCIsIGNvbG9yOiBcImJnLWJsdWUtMTAwIHRleHQtYmx1ZS04MDBcIiwgdmFyaWFudDogXCJvdXRsaW5lXCIgYXMgY29uc3QgfSxcclxuICB9O1xyXG5cclxuICByZXR1cm4gY29uZmlnc1tzdGF0dXMgYXMga2V5b2YgdHlwZW9mIGNvbmZpZ3NdIHx8IHtcclxuICAgIGxhYmVsOiBzdGF0dXMsXHJcbiAgICBjb2xvcjogXCJiZy1ncmF5LTEwMCB0ZXh0LWdyYXktODAwXCIsXHJcbiAgICB2YXJpYW50OiBcInNlY29uZGFyeVwiIGFzIGNvbnN0XHJcbiAgfTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2U8VCBleHRlbmRzICguLi5hcmdzOiB1bmtub3duW10pID0+IHVua25vd24+KFxyXG4gIGZ1bmM6IFQsXHJcbiAgd2FpdDogbnVtYmVyXHJcbik6ICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KSA9PiB2b2lkIHtcclxuICBsZXQgdGltZW91dDogTm9kZUpTLlRpbWVvdXQ7XHJcbiAgXHJcbiAgcmV0dXJuICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KSA9PiB7XHJcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XHJcbiAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBmdW5jKC4uLmFyZ3MpLCB3YWl0KTtcclxuICB9O1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRGaWxlU2l6ZShieXRlczogbnVtYmVyKTogc3RyaW5nIHtcclxuICBpZiAoYnl0ZXMgPT09IDApIHJldHVybiAnMCBCeXRlcyc7XHJcbiAgXHJcbiAgY29uc3QgayA9IDEwMjQ7XHJcbiAgY29uc3Qgc2l6ZXMgPSBbJ0J5dGVzJywgJ0tCJywgJ01CJywgJ0dCJ107XHJcbiAgY29uc3QgaSA9IE1hdGguZmxvb3IoTWF0aC5sb2coYnl0ZXMpIC8gTWF0aC5sb2coaykpO1xyXG4gIFxyXG4gIHJldHVybiBwYXJzZUZsb2F0KChieXRlcyAvIE1hdGgucG93KGssIGkpKS50b0ZpeGVkKDIpKSArICcgJyArIHNpemVzW2ldO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRJbWFnZUZpbGUoZmlsZW5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHZhbGlkRXh0ZW5zaW9ucyA9IFsnLmpwZycsICcuanBlZycsICcucG5nJywgJy5naWYnLCAnLndlYnAnXTtcclxuICBjb25zdCBleHRlbnNpb24gPSBmaWxlbmFtZS50b0xvd2VyQ2FzZSgpLnN1YnN0cmluZyhmaWxlbmFtZS5sYXN0SW5kZXhPZignLicpKTtcclxuICByZXR1cm4gdmFsaWRFeHRlbnNpb25zLmluY2x1ZGVzKGV4dGVuc2lvbik7XHJcbn1cclxuIl0sInZlcnNpb24iOjN9