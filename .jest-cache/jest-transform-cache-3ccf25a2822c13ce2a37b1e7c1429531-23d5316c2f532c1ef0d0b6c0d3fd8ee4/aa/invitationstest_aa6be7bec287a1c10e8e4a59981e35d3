d21892de96c279d0608ce812340f4001
"use strict";
/**
 * Tests para la API de invitaciones masivas de cortesía
 * @file /api/events/[id]/invitations
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// Mock Next.js Response
jest.mock('next/server', () => {
    class NextResponse {
        constructor(body, opts) {
            this.status = (opts === null || opts === void 0 ? void 0 : opts.status) || 200;
            this.body = body;
            this.headers = (opts === null || opts === void 0 ? void 0 : opts.headers) || {};
        }
        static json(body, opts) {
            return { status: (opts === null || opts === void 0 ? void 0 : opts.status) || 200, body };
        }
    }
    return { NextResponse };
});
jest.mock('@/lib/prisma', () => ({ prisma: mockPrisma }));
jest.mock('@/lib/auth', () => ({
    getCurrentUser: mockGetCurrentUser,
}));
// Mock Prisma
const mockPrisma = {
    event: {
        findUnique: jest.fn(),
    },
    courtesyInvitation: {
        findMany: jest.fn(),
        create: jest.fn(),
    },
    $transaction: jest.fn(),
};
// Mock Auth
const mockGetCurrentUser = jest.fn();
describe('API /api/events/[id]/invitations', () => {
    const mockEventId = 'event-123';
    const mockUser = {
        id: 'user-123',
        email: 'organizer@test.com',
        role: 'ORGANIZER',
    };
    const mockEvent = {
        id: mockEventId,
        title: 'Test Event',
        organizerId: mockUser.id,
        organizer: { id: mockUser.id },
    };
    beforeEach(() => {
        jest.clearAllMocks();
        mockGetCurrentUser.mockResolvedValue(mockUser);
        mockPrisma.event.findUnique.mockResolvedValue(mockEvent);
    });
    describe('GET - Listar invitaciones', () => {
        it('debería retornar lista de invitaciones exitosamente', async () => {
            const mockInvitations = [
                {
                    id: 'inv-1',
                    invitedEmail: 'test1@example.com',
                    invitedName: 'Test User 1',
                    status: 'PENDING',
                    createdAt: new Date(),
                    ticket: null,
                    creator: {
                        firstName: 'John',
                        lastName: 'Doe',
                        email: 'john@test.com',
                    },
                },
                {
                    id: 'inv-2',
                    invitedEmail: 'test2@example.com',
                    invitedName: 'Test User 2',
                    status: 'SENT',
                    createdAt: new Date(),
                    ticket: null,
                    creator: {
                        firstName: 'John',
                        lastName: 'Doe',
                        email: 'john@test.com',
                    },
                },
            ];
            mockPrisma.courtesyInvitation.findMany.mockResolvedValue(mockInvitations);
            const { GET } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await GET({}, { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(200);
            expect(res.body.invitations).toHaveLength(2);
            expect(res.body.event.title).toBe('Test Event');
            expect(mockPrisma.courtesyInvitation.findMany).toHaveBeenCalledWith({
                where: { eventId: mockEventId },
                include: {
                    ticket: {
                        select: {
                            id: true,
                            qrCode: true,
                            isUsed: true,
                            usedAt: true,
                        },
                    },
                    creator: {
                        select: {
                            firstName: true,
                            lastName: true,
                            email: true,
                        },
                    },
                },
                orderBy: { createdAt: 'desc' },
            });
        });
        it('debería retornar 401 si no hay usuario autenticado', async () => {
            mockGetCurrentUser.mockResolvedValue(null);
            const { GET } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await GET({}, { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(401);
            expect(res.body.error).toBe('No autorizado');
        });
        it('debería retornar 404 si el evento no existe', async () => {
            mockPrisma.event.findUnique.mockResolvedValue(null);
            const { GET } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await GET({}, { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(404);
            expect(res.body.error).toBe('Evento no encontrado');
        });
        it('debería retornar 403 si el usuario no es propietario ni admin', async () => {
            const unauthorizedUser = Object.assign(Object.assign({}, mockUser), { id: 'other-user', role: 'CLIENT' });
            mockGetCurrentUser.mockResolvedValue(unauthorizedUser);
            const { GET } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await GET({}, { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(403);
            expect(res.body.error).toBe('No autorizado');
        });
    });
    describe('POST - Crear invitaciones', () => {
        const mockRequest = (body) => ({
            json: jest.fn().mockResolvedValue(body),
        });
        it('debería crear una invitación individual exitosamente', async () => {
            const singleInvitation = {
                invitedEmail: 'test@example.com',
                invitedName: 'Test User',
                message: 'Ven a mi evento!',
            };
            const createdInvitation = Object.assign(Object.assign({ id: 'inv-123' }, singleInvitation), { invitedEmail: singleInvitation.invitedEmail.toLowerCase(), eventId: mockEventId, createdBy: mockUser.id, invitationCode: 'abc123def456', expiresAt: expect.any(Date), creator: {
                    firstName: 'John',
                    lastName: 'Doe',
                    email: 'john@test.com',
                } });
            // Mock que no hay invitaciones existentes
            mockPrisma.courtesyInvitation.findMany.mockResolvedValue([]);
            // Mock creación exitosa
            mockPrisma.$transaction.mockResolvedValue([createdInvitation]);
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(singleInvitation), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(201);
            expect(res.body.message).toContain('1 invitación(es) creada(s) exitosamente');
            expect(res.body.invitations).toHaveLength(1);
            expect(mockPrisma.$transaction).toHaveBeenCalled();
        });
        it('debería crear múltiples invitaciones masivas exitosamente', async () => {
            const bulkInvitations = {
                invitations: [
                    {
                        invitedEmail: 'test1@example.com',
                        invitedName: 'Test User 1',
                    },
                    {
                        invitedEmail: 'test2@example.com',
                        invitedName: 'Test User 2',
                    },
                    {
                        invitedEmail: 'test3@example.com',
                        invitedName: 'Test User 3',
                    },
                ],
            };
            const createdInvitations = bulkInvitations.invitations.map((inv, index) => (Object.assign(Object.assign({ id: `inv-${index + 1}` }, inv), { invitedEmail: inv.invitedEmail.toLowerCase(), eventId: mockEventId, createdBy: mockUser.id, invitationCode: `code${index + 1}`, expiresAt: expect.any(Date), creator: {
                    firstName: 'John',
                    lastName: 'Doe',
                    email: 'john@test.com',
                } })));
            // Mock que no hay invitaciones existentes
            mockPrisma.courtesyInvitation.findMany.mockResolvedValue([]);
            // Mock creación exitosa
            mockPrisma.$transaction.mockResolvedValue(createdInvitations);
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(bulkInvitations), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(201);
            expect(res.body.message).toContain('3 invitación(es) creada(s) exitosamente');
            expect(res.body.invitations).toHaveLength(3);
            expect(mockPrisma.$transaction).toHaveBeenCalled();
        });
        it('debería rechazar más de 50 invitaciones masivas', async () => {
            const tooManyInvitations = {
                invitations: Array.from({ length: 51 }, (_, i) => ({
                    invitedEmail: `test${i + 1}@example.com`,
                    invitedName: `Test User ${i + 1}`,
                })),
            };
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(tooManyInvitations), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Datos inválidos');
            expect(res.body.details).toBeDefined();
        });
        it('debería rechazar emails duplicados existentes', async () => {
            const duplicateInvitation = {
                invitedEmail: 'existing@example.com',
                invitedName: 'Existing User',
            };
            // Mock que ya existe una invitación con este email
            mockPrisma.courtesyInvitation.findMany.mockResolvedValue([
                { invitedEmail: 'existing@example.com' },
            ]);
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(duplicateInvitation), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Algunos emails ya están invitados a este evento');
            expect(res.body.duplicateEmails).toContain('existing@example.com');
        });
        it('debería validar formato de email inválido', async () => {
            const invalidEmailInvitation = {
                invitedEmail: 'invalid-email',
                invitedName: 'Test User',
            };
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(invalidEmailInvitation), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Datos inválidos');
        });
        it('debería rechazar lista vacía de invitaciones', async () => {
            const emptyInvitations = {
                invitations: [],
            };
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(emptyInvitations), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Datos inválidos');
        });
        it('debería manejar errores de base de datos', async () => {
            const validInvitation = {
                invitedEmail: 'test@example.com',
                invitedName: 'Test User',
            };
            // Mock que no hay invitaciones existentes
            mockPrisma.courtesyInvitation.findMany.mockResolvedValue([]);
            // Mock error en transacción
            mockPrisma.$transaction.mockRejectedValue(new Error('Database error'));
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(validInvitation), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(500);
            expect(res.body.error).toBe('Error interno del servidor');
        });
    });
    describe('Validaciones de esquema', () => {
        const mockRequest = (body) => ({
            json: jest.fn().mockResolvedValue(body),
        });
        it('debería validar campos requeridos para invitación individual', async () => {
            const incompleteInvitation = {
                invitedName: 'Test User', // Falta email
            };
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(incompleteInvitation), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Datos inválidos');
        });
        it('debería validar tipos de datos correctos', async () => {
            const invalidDataTypes = {
                invitedEmail: 123, // Debería ser string
                invitedName: ['array'], // Debería ser string
            };
            const { POST } = await Promise.resolve().then(() => __importStar(require('@/app/api/events/[id]/invitations/route')));
            const res = await POST(mockRequest(invalidDataTypes), { params: Promise.resolve({ id: mockEventId }) });
            expect(res.status).toBe(400);
            expect(res.body.error).toBe('Datos inválidos');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxCaWx1clxcRG9jdW1lbnRzXFxEZXZlbG9wbWVudFxcTmV4dFxcc29yeWNrLWFjY2Vzc1xcc3JjXFxfX3Rlc3RzX19cXGFwaVxcaW52aXRhdGlvbnMudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUlILHdCQUF3QjtBQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7SUFDNUIsTUFBTSxZQUFZO1FBSWhCLFlBQVksSUFBVSxFQUFFLElBQVU7WUFDaEMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFBLElBQUksYUFBSixJQUFJLHVCQUFKLElBQUksQ0FBRSxNQUFNLEtBQUksR0FBRyxDQUFDO1lBQ2xDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO1lBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsQ0FBQSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsT0FBTyxLQUFJLEVBQUUsQ0FBQztRQUNyQyxDQUFDO1FBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFTLEVBQUUsSUFBVTtZQUMvQixPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUEsSUFBSSxhQUFKLElBQUksdUJBQUosSUFBSSxDQUFFLE1BQU0sS0FBSSxHQUFHLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDL0MsQ0FBQztLQUNGO0lBQ0QsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDO0FBQzFCLENBQUMsQ0FBQyxDQUFDO0FBY0gsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFJMUQsSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUM3QixjQUFjLEVBQUUsa0JBQWtCO0NBQ25DLENBQUMsQ0FBQyxDQUFDO0FBbEJKLGNBQWM7QUFDZCxN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LENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUNqRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCxNQUFNLGdCQUFnQixHQUFHO2dCQUN2QixZQUFZLEVBQUUsR0FBRyxFQUFFLHFCQUFxQjtnQkFDeEMsV0FBVyxFQUFFLENBQUMsT0FBTyxDQUFDLEVBQUUscUJBQXFCO2FBQzlDLENBQUM7WUFFRixNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsd0RBQWEseUNBQXlDLEdBQUMsQ0FBQztZQUN6RSxNQUFNLEdBQUcsR0FBRyxNQUFNLElBQUksQ0FDcEIsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEVBQzdCLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBUyxDQUN4RCxDQUFDO1lBRUYsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDN0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQmlsdXJcXERvY3VtZW50c1xcRGV2ZWxvcG1lbnRcXE5leHRcXHNvcnljay1hY2Nlc3NcXHNyY1xcX190ZXN0c19fXFxhcGlcXGludml0YXRpb25zLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFRlc3RzIHBhcmEgbGEgQVBJIGRlIGludml0YWNpb25lcyBtYXNpdmFzIGRlIGNvcnRlc8OtYVxyXG4gKiBAZmlsZSAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcblxyXG4vLyBNb2NrIE5leHQuanMgUmVzcG9uc2VcclxuamVzdC5tb2NrKCduZXh0L3NlcnZlcicsICgpID0+IHtcclxuICBjbGFzcyBOZXh0UmVzcG9uc2Uge1xyXG4gICAgc3RhdHVzOiBudW1iZXI7XHJcbiAgICBib2R5OiBhbnk7XHJcbiAgICBoZWFkZXJzOiBhbnk7XHJcbiAgICBjb25zdHJ1Y3Rvcihib2R5PzogYW55LCBvcHRzPzogYW55KSB7XHJcbiAgICAgIHRoaXMuc3RhdHVzID0gb3B0cz8uc3RhdHVzIHx8IDIwMDtcclxuICAgICAgdGhpcy5ib2R5ID0gYm9keTtcclxuICAgICAgdGhpcy5oZWFkZXJzID0gb3B0cz8uaGVhZGVycyB8fCB7fTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBqc29uKGJvZHk6IGFueSwgb3B0cz86IGFueSkge1xyXG4gICAgICByZXR1cm4geyBzdGF0dXM6IG9wdHM/LnN0YXR1cyB8fCAyMDAsIGJvZHkgfTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHsgTmV4dFJlc3BvbnNlIH07XHJcbn0pO1xyXG5cclxuLy8gTW9jayBQcmlzbWFcclxuY29uc3QgbW9ja1ByaXNtYSA9IHtcclxuICBldmVudDoge1xyXG4gICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxyXG4gIH0sXHJcbiAgY291cnRlc3lJbnZpdGF0aW9uOiB7XHJcbiAgICBmaW5kTWFueTogamVzdC5mbigpLFxyXG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXHJcbiAgfSxcclxuICAkdHJhbnNhY3Rpb246IGplc3QuZm4oKSxcclxufTtcclxuXHJcbmplc3QubW9jaygnQC9saWIvcHJpc21hJywgKCkgPT4gKHsgcHJpc21hOiBtb2NrUHJpc21hIH0pKTtcclxuXHJcbi8vIE1vY2sgQXV0aFxyXG5jb25zdCBtb2NrR2V0Q3VycmVudFVzZXIgPSBqZXN0LmZuKCk7XHJcbmplc3QubW9jaygnQC9saWIvYXV0aCcsICgpID0+ICh7XHJcbiAgZ2V0Q3VycmVudFVzZXI6IG1vY2tHZXRDdXJyZW50VXNlcixcclxufSkpO1xyXG5cclxuZGVzY3JpYmUoJ0FQSSAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zJywgKCkgPT4ge1xyXG4gIGNvbnN0IG1vY2tFdmVudElkID0gJ2V2ZW50LTEyMyc7XHJcbiAgY29uc3QgbW9ja1VzZXIgPSB7XHJcbiAgICBpZDogJ3VzZXItMTIzJyxcclxuICAgIGVtYWlsOiAnb3JnYW5pemVyQHRlc3QuY29tJyxcclxuICAgIHJvbGU6ICdPUkdBTklaRVInLFxyXG4gIH07XHJcbiAgY29uc3QgbW9ja0V2ZW50ID0ge1xyXG4gICAgaWQ6IG1vY2tFdmVudElkLFxyXG4gICAgdGl0bGU6ICdUZXN0IEV2ZW50JyxcclxuICAgIG9yZ2FuaXplcklkOiBtb2NrVXNlci5pZCxcclxuICAgIG9yZ2FuaXplcjogeyBpZDogbW9ja1VzZXIuaWQgfSxcclxuICB9O1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgbW9ja0dldEN1cnJlbnRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tVc2VyKTtcclxuICAgIG1vY2tQcmlzbWEuZXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRXZlbnQpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnR0VUIC0gTGlzdGFyIGludml0YWNpb25lcycsICgpID0+IHtcclxuICAgIGl0KCdkZWJlcsOtYSByZXRvcm5hciBsaXN0YSBkZSBpbnZpdGFjaW9uZXMgZXhpdG9zYW1lbnRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrSW52aXRhdGlvbnMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6ICdpbnYtMScsXHJcbiAgICAgICAgICBpbnZpdGVkRW1haWw6ICd0ZXN0MUBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgICBpbnZpdGVkTmFtZTogJ1Rlc3QgVXNlciAxJyxcclxuICAgICAgICAgIHN0YXR1czogJ1BFTkRJTkcnLFxyXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgdGlja2V0OiBudWxsLFxyXG4gICAgICAgICAgY3JlYXRvcjoge1xyXG4gICAgICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcclxuICAgICAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxyXG4gICAgICAgICAgICBlbWFpbDogJ2pvaG5AdGVzdC5jb20nLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiAnaW52LTInLFxyXG4gICAgICAgICAgaW52aXRlZEVtYWlsOiAndGVzdDJAZXhhbXBsZS5jb20nLFxyXG4gICAgICAgICAgaW52aXRlZE5hbWU6ICdUZXN0IFVzZXIgMicsXHJcbiAgICAgICAgICBzdGF0dXM6ICdTRU5UJyxcclxuICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgICAgIHRpY2tldDogbnVsbCxcclxuICAgICAgICAgIGNyZWF0b3I6IHtcclxuICAgICAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXHJcbiAgICAgICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcclxuICAgICAgICAgICAgZW1haWw6ICdqb2huQHRlc3QuY29tJyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgXTtcclxuXHJcbiAgICAgIG1vY2tQcmlzbWEuY291cnRlc3lJbnZpdGF0aW9uLmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tJbnZpdGF0aW9ucyk7XHJcblxyXG4gICAgICBjb25zdCB7IEdFVCB9ID0gYXdhaXQgaW1wb3J0KCdAL2FwcC9hcGkvZXZlbnRzL1tpZF0vaW52aXRhdGlvbnMvcm91dGUnKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgR0VUKFxyXG4gICAgICAgIHt9IGFzIE5leHRSZXF1ZXN0LFxyXG4gICAgICAgIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogbW9ja0V2ZW50SWQgfSkgfSBhcyBhbnlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXMuYm9keS5pbnZpdGF0aW9ucykudG9IYXZlTGVuZ3RoKDIpO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXZlbnQudGl0bGUpLnRvQmUoJ1Rlc3QgRXZlbnQnKTtcclxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWEuY291cnRlc3lJbnZpdGF0aW9uLmZpbmRNYW55KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XHJcbiAgICAgICAgd2hlcmU6IHsgZXZlbnRJZDogbW9ja0V2ZW50SWQgfSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICB0aWNrZXQ6IHtcclxuICAgICAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgcXJDb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICAgIGlzVXNlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICB1c2VkQXQ6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY3JlYXRvcjoge1xyXG4gICAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgICBmaXJzdE5hbWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgbGFzdE5hbWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgZW1haWw6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSByZXRvcm5hciA0MDEgc2kgbm8gaGF5IHVzdWFyaW8gYXV0ZW50aWNhZG8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tHZXRDdXJyZW50VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgIGNvbnN0IHsgR0VUIH0gPSBhd2FpdCBpbXBvcnQoJ0AvYXBwL2FwaS9ldmVudHMvW2lkXS9pbnZpdGF0aW9ucy9yb3V0ZScpO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBHRVQoXHJcbiAgICAgICAge30gYXMgTmV4dFJlcXVlc3QsXHJcbiAgICAgICAgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiBtb2NrRXZlbnRJZCB9KSB9IGFzIGFueVxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvQmUoNDAxKTtcclxuICAgICAgZXhwZWN0KHJlcy5ib2R5LmVycm9yKS50b0JlKCdObyBhdXRvcml6YWRvJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGViZXLDrWEgcmV0b3JuYXIgNDA0IHNpIGVsIGV2ZW50byBubyBleGlzdGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tQcmlzbWEuZXZlbnQuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgIGNvbnN0IHsgR0VUIH0gPSBhd2FpdCBpbXBvcnQoJ0AvYXBwL2FwaS9ldmVudHMvW2lkXS9pbnZpdGF0aW9ucy9yb3V0ZScpO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBHRVQoXHJcbiAgICAgICAge30gYXMgTmV4dFJlcXVlc3QsXHJcbiAgICAgICAgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiBtb2NrRXZlbnRJZCB9KSB9IGFzIGFueVxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvQmUoNDA0KTtcclxuICAgICAgZXhwZWN0KHJlcy5ib2R5LmVycm9yKS50b0JlKCdFdmVudG8gbm8gZW5jb250cmFkbycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RlYmVyw61hIHJldG9ybmFyIDQwMyBzaSBlbCB1c3VhcmlvIG5vIGVzIHByb3BpZXRhcmlvIG5pIGFkbWluJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB1bmF1dGhvcml6ZWRVc2VyID0geyAuLi5tb2NrVXNlciwgaWQ6ICdvdGhlci11c2VyJywgcm9sZTogJ0NMSUVOVCcgfTtcclxuICAgICAgbW9ja0dldEN1cnJlbnRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHVuYXV0aG9yaXplZFVzZXIpO1xyXG5cclxuICAgICAgY29uc3QgeyBHRVQgfSA9IGF3YWl0IGltcG9ydCgnQC9hcHAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zL3JvdXRlJyk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IEdFVChcclxuICAgICAgICB7fSBhcyBOZXh0UmVxdWVzdCxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDMpO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ05vIGF1dG9yaXphZG8nKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnUE9TVCAtIENyZWFyIGludml0YWNpb25lcycsICgpID0+IHtcclxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0gKGJvZHk6IGFueSkgPT4gKHtcclxuICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGJvZHkpLFxyXG4gICAgfSkgYXMgYW55IGFzIE5leHRSZXF1ZXN0O1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSBjcmVhciB1bmEgaW52aXRhY2nDs24gaW5kaXZpZHVhbCBleGl0b3NhbWVudGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNpbmdsZUludml0YXRpb24gPSB7XHJcbiAgICAgICAgaW52aXRlZEVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgaW52aXRlZE5hbWU6ICdUZXN0IFVzZXInLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdWZW4gYSBtaSBldmVudG8hJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IGNyZWF0ZWRJbnZpdGF0aW9uID0ge1xyXG4gICAgICAgIGlkOiAnaW52LTEyMycsXHJcbiAgICAgICAgLi4uc2luZ2xlSW52aXRhdGlvbixcclxuICAgICAgICBpbnZpdGVkRW1haWw6IHNpbmdsZUludml0YXRpb24uaW52aXRlZEVtYWlsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgZXZlbnRJZDogbW9ja0V2ZW50SWQsXHJcbiAgICAgICAgY3JlYXRlZEJ5OiBtb2NrVXNlci5pZCxcclxuICAgICAgICBpbnZpdGF0aW9uQ29kZTogJ2FiYzEyM2RlZjQ1NicsXHJcbiAgICAgICAgZXhwaXJlc0F0OiBleHBlY3QuYW55KERhdGUpLFxyXG4gICAgICAgIGNyZWF0b3I6IHtcclxuICAgICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxyXG4gICAgICAgICAgbGFzdE5hbWU6ICdEb2UnLFxyXG4gICAgICAgICAgZW1haWw6ICdqb2huQHRlc3QuY29tJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgLy8gTW9jayBxdWUgbm8gaGF5IGludml0YWNpb25lcyBleGlzdGVudGVzXHJcbiAgICAgIG1vY2tQcmlzbWEuY291cnRlc3lJbnZpdGF0aW9uLmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKFtdKTtcclxuICAgICAgXHJcbiAgICAgIC8vIE1vY2sgY3JlYWNpw7NuIGV4aXRvc2FcclxuICAgICAgbW9ja1ByaXNtYS4kdHJhbnNhY3Rpb24ubW9ja1Jlc29sdmVkVmFsdWUoW2NyZWF0ZWRJbnZpdGF0aW9uXSk7XHJcblxyXG4gICAgICBjb25zdCB7IFBPU1QgfSA9IGF3YWl0IGltcG9ydCgnQC9hcHAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zL3JvdXRlJyk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFBPU1QoXHJcbiAgICAgICAgbW9ja1JlcXVlc3Qoc2luZ2xlSW52aXRhdGlvbiksXHJcbiAgICAgICAgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiBtb2NrRXZlbnRJZCB9KSB9IGFzIGFueVxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvQmUoMjAxKTtcclxuICAgICAgZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignMSBpbnZpdGFjacOzbihlcykgY3JlYWRhKHMpIGV4aXRvc2FtZW50ZScpO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuaW52aXRhdGlvbnMpLnRvSGF2ZUxlbmd0aCgxKTtcclxuICAgICAgZXhwZWN0KG1vY2tQcmlzbWEuJHRyYW5zYWN0aW9uKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGViZXLDrWEgY3JlYXIgbcO6bHRpcGxlcyBpbnZpdGFjaW9uZXMgbWFzaXZhcyBleGl0b3NhbWVudGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJ1bGtJbnZpdGF0aW9ucyA9IHtcclxuICAgICAgICBpbnZpdGF0aW9uczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBpbnZpdGVkRW1haWw6ICd0ZXN0MUBleGFtcGxlLmNvbScsXHJcbiAgICAgICAgICAgIGludml0ZWROYW1lOiAnVGVzdCBVc2VyIDEnLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaW52aXRlZEVtYWlsOiAndGVzdDJAZXhhbXBsZS5jb20nLFxyXG4gICAgICAgICAgICBpbnZpdGVkTmFtZTogJ1Rlc3QgVXNlciAyJyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGludml0ZWRFbWFpbDogJ3Rlc3QzQGV4YW1wbGUuY29tJyxcclxuICAgICAgICAgICAgaW52aXRlZE5hbWU6ICdUZXN0IFVzZXIgMycsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIF0sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBjcmVhdGVkSW52aXRhdGlvbnMgPSBidWxrSW52aXRhdGlvbnMuaW52aXRhdGlvbnMubWFwKChpbnYsIGluZGV4KSA9PiAoe1xyXG4gICAgICAgIGlkOiBgaW52LSR7aW5kZXggKyAxfWAsXHJcbiAgICAgICAgLi4uaW52LFxyXG4gICAgICAgIGludml0ZWRFbWFpbDogaW52Lmludml0ZWRFbWFpbC50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICAgIGV2ZW50SWQ6IG1vY2tFdmVudElkLFxyXG4gICAgICAgIGNyZWF0ZWRCeTogbW9ja1VzZXIuaWQsXHJcbiAgICAgICAgaW52aXRhdGlvbkNvZGU6IGBjb2RlJHtpbmRleCArIDF9YCxcclxuICAgICAgICBleHBpcmVzQXQ6IGV4cGVjdC5hbnkoRGF0ZSksXHJcbiAgICAgICAgY3JlYXRvcjoge1xyXG4gICAgICAgICAgZmlyc3ROYW1lOiAnSm9obicsXHJcbiAgICAgICAgICBsYXN0TmFtZTogJ0RvZScsXHJcbiAgICAgICAgICBlbWFpbDogJ2pvaG5AdGVzdC5jb20nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgIC8vIE1vY2sgcXVlIG5vIGhheSBpbnZpdGFjaW9uZXMgZXhpc3RlbnRlc1xyXG4gICAgICBtb2NrUHJpc21hLmNvdXJ0ZXN5SW52aXRhdGlvbi5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBNb2NrIGNyZWFjacOzbiBleGl0b3NhXHJcbiAgICAgIG1vY2tQcmlzbWEuJHRyYW5zYWN0aW9uLm1vY2tSZXNvbHZlZFZhbHVlKGNyZWF0ZWRJbnZpdGF0aW9ucyk7XHJcblxyXG4gICAgICBjb25zdCB7IFBPU1QgfSA9IGF3YWl0IGltcG9ydCgnQC9hcHAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zL3JvdXRlJyk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFBPU1QoXHJcbiAgICAgICAgbW9ja1JlcXVlc3QoYnVsa0ludml0YXRpb25zKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSgyMDEpO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkubWVzc2FnZSkudG9Db250YWluKCczIGludml0YWNpw7NuKGVzKSBjcmVhZGEocykgZXhpdG9zYW1lbnRlJyk7XHJcbiAgICAgIGV4cGVjdChyZXMuYm9keS5pbnZpdGF0aW9ucykudG9IYXZlTGVuZ3RoKDMpO1xyXG4gICAgICBleHBlY3QobW9ja1ByaXNtYS4kdHJhbnNhY3Rpb24pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSByZWNoYXphciBtw6FzIGRlIDUwIGludml0YWNpb25lcyBtYXNpdmFzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB0b29NYW55SW52aXRhdGlvbnMgPSB7XHJcbiAgICAgICAgaW52aXRhdGlvbnM6IEFycmF5LmZyb20oeyBsZW5ndGg6IDUxIH0sIChfLCBpKSA9PiAoe1xyXG4gICAgICAgICAgaW52aXRlZEVtYWlsOiBgdGVzdCR7aSArIDF9QGV4YW1wbGUuY29tYCxcclxuICAgICAgICAgIGludml0ZWROYW1lOiBgVGVzdCBVc2VyICR7aSArIDF9YCxcclxuICAgICAgICB9KSksXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCB7IFBPU1QgfSA9IGF3YWl0IGltcG9ydCgnQC9hcHAvYXBpL2V2ZW50cy9baWRdL2ludml0YXRpb25zL3JvdXRlJyk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFBPU1QoXHJcbiAgICAgICAgbW9ja1JlcXVlc3QodG9vTWFueUludml0YXRpb25zKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDApO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ0RhdG9zIGludsOhbGlkb3MnKTtcclxuICAgICAgZXhwZWN0KHJlcy5ib2R5LmRldGFpbHMpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGViZXLDrWEgcmVjaGF6YXIgZW1haWxzIGR1cGxpY2Fkb3MgZXhpc3RlbnRlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZHVwbGljYXRlSW52aXRhdGlvbiA9IHtcclxuICAgICAgICBpbnZpdGVkRW1haWw6ICdleGlzdGluZ0BleGFtcGxlLmNvbScsXHJcbiAgICAgICAgaW52aXRlZE5hbWU6ICdFeGlzdGluZyBVc2VyJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgcXVlIHlhIGV4aXN0ZSB1bmEgaW52aXRhY2nDs24gY29uIGVzdGUgZW1haWxcclxuICAgICAgbW9ja1ByaXNtYS5jb3VydGVzeUludml0YXRpb24uZmluZE1hbnkubW9ja1Jlc29sdmVkVmFsdWUoW1xyXG4gICAgICAgIHsgaW52aXRlZEVtYWlsOiAnZXhpc3RpbmdAZXhhbXBsZS5jb20nIH0sXHJcbiAgICAgIF0pO1xyXG5cclxuICAgICAgY29uc3QgeyBQT1NUIH0gPSBhd2FpdCBpbXBvcnQoJ0AvYXBwL2FwaS9ldmVudHMvW2lkXS9pbnZpdGF0aW9ucy9yb3V0ZScpO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBQT1NUKFxyXG4gICAgICAgIG1vY2tSZXF1ZXN0KGR1cGxpY2F0ZUludml0YXRpb24pLFxyXG4gICAgICAgIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogbW9ja0V2ZW50SWQgfSkgfSBhcyBhbnlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0JlKDQwMCk7XHJcbiAgICAgIGV4cGVjdChyZXMuYm9keS5lcnJvcikudG9CZSgnQWxndW5vcyBlbWFpbHMgeWEgZXN0w6FuIGludml0YWRvcyBhIGVzdGUgZXZlbnRvJyk7XHJcbiAgICAgIGV4cGVjdChyZXMuYm9keS5kdXBsaWNhdGVFbWFpbHMpLnRvQ29udGFpbignZXhpc3RpbmdAZXhhbXBsZS5jb20nKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSB2YWxpZGFyIGZvcm1hdG8gZGUgZW1haWwgaW52w6FsaWRvJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBpbnZhbGlkRW1haWxJbnZpdGF0aW9uID0ge1xyXG4gICAgICAgIGludml0ZWRFbWFpbDogJ2ludmFsaWQtZW1haWwnLFxyXG4gICAgICAgIGludml0ZWROYW1lOiAnVGVzdCBVc2VyJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHsgUE9TVCB9ID0gYXdhaXQgaW1wb3J0KCdAL2FwcC9hcGkvZXZlbnRzL1tpZF0vaW52aXRhdGlvbnMvcm91dGUnKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgUE9TVChcclxuICAgICAgICBtb2NrUmVxdWVzdChpbnZhbGlkRW1haWxJbnZpdGF0aW9uKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDApO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ0RhdG9zIGludsOhbGlkb3MnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSByZWNoYXphciBsaXN0YSB2YWPDrWEgZGUgaW52aXRhY2lvbmVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBlbXB0eUludml0YXRpb25zID0ge1xyXG4gICAgICAgIGludml0YXRpb25zOiBbXSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHsgUE9TVCB9ID0gYXdhaXQgaW1wb3J0KCdAL2FwcC9hcGkvZXZlbnRzL1tpZF0vaW52aXRhdGlvbnMvcm91dGUnKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgUE9TVChcclxuICAgICAgICBtb2NrUmVxdWVzdChlbXB0eUludml0YXRpb25zKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDApO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ0RhdG9zIGludsOhbGlkb3MnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSBtYW5lamFyIGVycm9yZXMgZGUgYmFzZSBkZSBkYXRvcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgdmFsaWRJbnZpdGF0aW9uID0ge1xyXG4gICAgICAgIGludml0ZWRFbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxyXG4gICAgICAgIGludml0ZWROYW1lOiAnVGVzdCBVc2VyJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIE1vY2sgcXVlIG5vIGhheSBpbnZpdGFjaW9uZXMgZXhpc3RlbnRlc1xyXG4gICAgICBtb2NrUHJpc21hLmNvdXJ0ZXN5SW52aXRhdGlvbi5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBNb2NrIGVycm9yIGVuIHRyYW5zYWNjacOzblxyXG4gICAgICBtb2NrUHJpc21hLiR0cmFuc2FjdGlvbi5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGVycm9yJykpO1xyXG5cclxuICAgICAgY29uc3QgeyBQT1NUIH0gPSBhd2FpdCBpbXBvcnQoJ0AvYXBwL2FwaS9ldmVudHMvW2lkXS9pbnZpdGF0aW9ucy9yb3V0ZScpO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBQT1NUKFxyXG4gICAgICAgIG1vY2tSZXF1ZXN0KHZhbGlkSW52aXRhdGlvbiksXHJcbiAgICAgICAgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiBtb2NrRXZlbnRJZCB9KSB9IGFzIGFueVxyXG4gICAgICApO1xyXG5cclxuICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvQmUoNTAwKTtcclxuICAgICAgZXhwZWN0KHJlcy5ib2R5LmVycm9yKS50b0JlKCdFcnJvciBpbnRlcm5vIGRlbCBzZXJ2aWRvcicpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdWYWxpZGFjaW9uZXMgZGUgZXNxdWVtYScsICgpID0+IHtcclxuICAgIGNvbnN0IG1vY2tSZXF1ZXN0ID0gKGJvZHk6IGFueSkgPT4gKHtcclxuICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKGJvZHkpLFxyXG4gICAgfSkgYXMgYW55IGFzIE5leHRSZXF1ZXN0O1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSB2YWxpZGFyIGNhbXBvcyByZXF1ZXJpZG9zIHBhcmEgaW52aXRhY2nDs24gaW5kaXZpZHVhbCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgaW5jb21wbGV0ZUludml0YXRpb24gPSB7XHJcbiAgICAgICAgaW52aXRlZE5hbWU6ICdUZXN0IFVzZXInLCAvLyBGYWx0YSBlbWFpbFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgeyBQT1NUIH0gPSBhd2FpdCBpbXBvcnQoJ0AvYXBwL2FwaS9ldmVudHMvW2lkXS9pbnZpdGF0aW9ucy9yb3V0ZScpO1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBQT1NUKFxyXG4gICAgICAgIG1vY2tSZXF1ZXN0KGluY29tcGxldGVJbnZpdGF0aW9uKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDApO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ0RhdG9zIGludsOhbGlkb3MnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSB2YWxpZGFyIHRpcG9zIGRlIGRhdG9zIGNvcnJlY3RvcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgaW52YWxpZERhdGFUeXBlcyA9IHtcclxuICAgICAgICBpbnZpdGVkRW1haWw6IDEyMywgLy8gRGViZXLDrWEgc2VyIHN0cmluZ1xyXG4gICAgICAgIGludml0ZWROYW1lOiBbJ2FycmF5J10sIC8vIERlYmVyw61hIHNlciBzdHJpbmdcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHsgUE9TVCB9ID0gYXdhaXQgaW1wb3J0KCdAL2FwcC9hcGkvZXZlbnRzL1tpZF0vaW52aXRhdGlvbnMvcm91dGUnKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgUE9TVChcclxuICAgICAgICBtb2NrUmVxdWVzdChpbnZhbGlkRGF0YVR5cGVzKSxcclxuICAgICAgICB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6IG1vY2tFdmVudElkIH0pIH0gYXMgYW55XHJcbiAgICAgICk7XHJcblxyXG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9CZSg0MDApO1xyXG4gICAgICBleHBlY3QocmVzLmJvZHkuZXJyb3IpLnRvQmUoJ0RhdG9zIGludsOhbGlkb3MnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9