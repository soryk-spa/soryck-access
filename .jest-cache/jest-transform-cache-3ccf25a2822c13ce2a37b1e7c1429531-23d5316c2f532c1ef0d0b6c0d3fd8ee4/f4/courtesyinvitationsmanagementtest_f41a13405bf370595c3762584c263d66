7405a82063d38280fc06937198820d89
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
// Mock de Sonner Toast
jest.mock('sonner', () => ({
    toast: {
        error: jest.fn(),
        success: jest.fn(),
        warning: jest.fn(),
    },
}));
/**
 * Tests para el componente CourtesyInvitationsManagement
 * @file components/courtesy-invitations-management.tsx
 */
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const sonner_1 = require("sonner");
const courtesy_invitations_management_1 = __importDefault(require("../../components/courtesy-invitations-management"));
// Mock de fetch global
const mockFetch = jest.fn();
global.fetch = mockFetch;
// Mock de window.URL.createObjectURL para exportar
Object.defineProperty(window, 'URL', {
    value: {
        createObjectURL: jest.fn(() => 'mock-url'),
        revokeObjectURL: jest.fn(),
    },
});
// Mock de createElement para link de descarga
const mockCreateElement = jest.fn();
const mockClick = jest.fn();
const mockRemove = jest.fn();
Object.defineProperty(document, 'createElement', {
    value: mockCreateElement.mockReturnValue({
        href: '',
        download: '',
        style: { display: '' },
        click: mockClick,
        remove: mockRemove,
    }),
});
Object.defineProperty(document.body, 'appendChild', {
    value: jest.fn(),
});
describe('CourtesyInvitationsManagement', () => {
    const mockProps = {
        eventId: 'event-123',
        eventTitle: 'Test Event',
    };
    const mockInvitations = [
        {
            id: 'inv-1',
            invitedEmail: 'test1@example.com',
            invitedName: 'Test User 1',
            status: 'PENDING',
            invitationCode: 'code123',
            expiresAt: '2025-12-31T23:59:59Z',
            createdAt: '2025-09-01T10:00:00Z',
            ticket: null,
            creator: {
                firstName: 'John',
                lastName: 'Doe',
                email: 'john@test.com',
            },
        },
        {
            id: 'inv-2',
            invitedEmail: 'test2@example.com',
            invitedName: 'Test User 2',
            status: 'SENT',
            invitationCode: 'code456',
            expiresAt: '2025-12-31T23:59:59Z',
            createdAt: '2025-09-01T11:00:00Z',
            ticket: {
                id: 'ticket-1',
                qrCode: 'QR123',
                isUsed: false,
                usedAt: null,
            },
            creator: {
                firstName: 'John',
                lastName: 'Doe',
                email: 'john@test.com',
            },
        },
    ];
    beforeEach(() => {
        jest.clearAllMocks();
        mockFetch.mockClear();
    });
    describe('Renderizado inicial', () => {
        it('debería renderizar el título y elementos principales', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: [],
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            expect(react_2.screen.getByText('Invitaciones de Cortesía')).toBeInTheDocument();
            expect(react_2.screen.getByText('Agregar Invitación Individual')).toBeInTheDocument();
            expect(react_2.screen.getByText('Invitación Masiva')).toBeInTheDocument();
            await (0, react_2.waitFor)(() => {
                expect(mockFetch).toHaveBeenCalledWith(`/api/events/${mockProps.eventId}/invitations`);
            });
        });
        it('debería mostrar la tabla de invitaciones cuando hay datos', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: mockInvitations,
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByText('test1@example.com')).toBeInTheDocument();
                expect(react_2.screen.getByText('Test User 1')).toBeInTheDocument();
                expect(react_2.screen.getByText('test2@example.com')).toBeInTheDocument();
                expect(react_2.screen.getByText('Test User 2')).toBeInTheDocument();
            });
            expect(react_2.screen.getByText('PENDING')).toBeInTheDocument();
            expect(react_2.screen.getByText('SENT')).toBeInTheDocument();
        });
        it('debería manejar errores al cargar invitaciones', async () => {
            mockFetch.mockRejectedValueOnce(new Error('Network error'));
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(sonner_1.toast.error).toHaveBeenCalledWith('Error al cargar las invitaciones');
            });
        });
    });
    describe('Invitación individual', () => {
        beforeEach(() => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: [],
                }),
            });
        });
        it('debería agregar una invitación individual exitosamente', async () => {
            // Mock respuesta exitosa para crear invitación
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    message: '1 invitación(es) creada(s) exitosamente',
                    invitations: [mockInvitations[0]],
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            // Esperar a que cargue
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByLabelText('Email *')).toBeInTheDocument();
            });
            // Llenar formulario
            const emailInput = react_2.screen.getByLabelText('Email *');
            const nameInput = react_2.screen.getByLabelText('Nombre (opcional)');
            react_2.fireEvent.change(emailInput, { target: { value: 'new@example.com' } });
            react_2.fireEvent.change(nameInput, { target: { value: 'New User' } });
            // Enviar
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: 'Agregar Invitación' }));
            await (0, react_2.waitFor)(() => {
                expect(mockFetch).toHaveBeenLastCalledWith(`/api/events/${mockProps.eventId}/invitations`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        invitedEmail: 'new@example.com',
                        invitedName: 'New User',
                    }),
                });
                expect(sonner_1.toast.success).toHaveBeenCalledWith('Invitación creada exitosamente');
            });
        });
        it('debería validar email requerido', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByLabelText('Email *')).toBeInTheDocument();
            });
            // Intentar enviar sin email
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: 'Agregar Invitación' }));
            expect(sonner_1.toast.error).toHaveBeenCalledWith('El email es requerido');
            expect(mockFetch).toHaveBeenCalledTimes(1); // Solo la carga inicial
        });
        it('debería manejar errores al crear invitación individual', async () => {
            // Mock error en creación
            mockFetch.mockResolvedValueOnce({
                ok: false,
                json: async () => ({ error: 'Email ya existe' }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByLabelText('Email *')).toBeInTheDocument();
            });
            const emailInput = react_2.screen.getByLabelText('Email *');
            react_2.fireEvent.change(emailInput, { target: { value: 'existing@example.com' } });
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: 'Agregar Invitación' }));
            await (0, react_2.waitFor)(() => {
                expect(sonner_1.toast.error).toHaveBeenCalledWith('Email ya existe');
            });
        });
    });
    describe('Invitaciones masivas', () => {
        beforeEach(() => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: [],
                }),
            });
        });
        it('debería abrir el modal de invitaciones masivas', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByText('Invitación Masiva')).toBeInTheDocument();
            });
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: /Invitación Masiva/i }));
            expect(react_2.screen.getByText('Agrega múltiples emails separados por líneas')).toBeInTheDocument();
            expect(react_2.screen.getByPlaceholderText(/usuario1@ejemplo.com/)).toBeInTheDocument();
        });
        it('debería validar que se agregue al menos un email', async () => {
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByText('Invitación Masiva')).toBeInTheDocument();
            });
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: /Invitación Masiva/i }));
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: 'Crear Invitaciones' }));
            expect(sonner_1.toast.error).toHaveBeenCalledWith('Debes agregar al menos un email');
        });
        it('debería procesar invitaciones masivas exitosamente', async () => {
            // Mock respuesta exitosa para invitaciones masivas
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    created: [mockInvitations[0], mockInvitations[1]],
                    errors: [],
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByText('Invitación Masiva')).toBeInTheDocument();
            });
            // Abrir modal
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: /Invitación Masiva/i }));
            // Llenar textarea con múltiples emails
            const textarea = react_2.screen.getByPlaceholderText(/usuario1@ejemplo.com/);
            react_2.fireEvent.change(textarea, {
                target: { value: 'user1@test.com, User One\nuser2@test.com, User Two\nuser3@test.com' }
            });
            // Enviar
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: 'Crear Invitaciones' }));
            await (0, react_2.waitFor)(() => {
                expect(mockFetch).toHaveBeenLastCalledWith(`/api/events/${mockProps.eventId}/invitations`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        invitations: [
                            { email: 'user1@test.com', name: 'User One' },
                            { email: 'user2@test.com', name: 'User Two' },
                            { email: 'user3@test.com', name: undefined },
                        ],
                    }),
                });
                expect(sonner_1.toast.success).toHaveBeenCalledWith('2 invitaciones creadas exitosamente');
            });
        });
    });
    describe('Exportar invitaciones', () => {
        it('debería exportar invitaciones a CSV', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: mockInvitations,
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByText('test1@example.com')).toBeInTheDocument();
            });
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: /Exportar/i }));
            expect(mockCreateElement).toHaveBeenCalledWith('a');
            expect(mockClick).toHaveBeenCalled();
            expect(mockRemove).toHaveBeenCalled();
        });
        it('debería mostrar mensaje cuando no hay invitaciones para exportar', async () => {
            mockFetch.mockResolvedValueOnce({
                ok: true,
                json: async () => ({
                    event: { id: 'event-123', title: 'Test Event' },
                    invitations: [],
                }),
            });
            (0, react_2.render)((0, jsx_runtime_1.jsx)(courtesy_invitations_management_1.default, Object.assign({}, mockProps)));
            await (0, react_2.waitFor)(() => {
                expect(react_2.screen.getByRole('button', { name: /Exportar/i })).toBeInTheDocument();
            });
            react_2.fireEvent.click(react_2.screen.getByRole('button', { name: /Exportar/i }));
            expect(sonner_1.toast.error).toHaveBeenCalledWith('No hay invitaciones para exportar');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxCaWx1clxcRG9jdW1lbnRzXFxEZXZlbG9wbWVudFxcTmV4dFxcc29yeWNrLWFjY2Vzc1xcc3JjXFxfX3Rlc3RzX19cXGNvbXBvbmVudHNcXGNvdXJ0ZXN5LWludml0YXRpb25zLW1hbmFnZW1lbnQudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBVUEsdUJBQXVCO0FBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDekIsS0FBSyxFQUFFO1FBQ0wsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDaEIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDbEIsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDbkI7Q0FDRixDQUFDLENBQUMsQ0FBQztBQWpCSjs7O0dBR0c7QUFFSCxrREFBMEI7QUFDMUIsa0RBQTRFO0FBQzVFLG1DQUErQjtBQUMvQix1SEFBNkY7QUFXN0YsdUJBQXVCO0FBQ3ZCLE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUM1QixNQUFNLENBQUMsS0FBSyxHQUFHLFNBQVMsQ0FBQztBQUV6QixtREFBbUQ7QUFDbkQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFO0lBQ25DLEtBQUssRUFBRTtRQUNMLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQztRQUMxQyxlQUFlLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUMzQjtDQUNGLENBQUMsQ0FBQztBQUVILDhDQUE4QztBQUM5QyxNQUFNLGlCQUFpQixHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUNwQyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDNUIsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBRTdCLE1BQU0sQ0FBQyxjQUFj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QUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUVuRSxNQUFNLENBQUMsY0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDLG1DQUFtQyxDQUFDLENBQUM7UUFDaEYsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQmlsdXJcXERvY3VtZW50c1xcRGV2ZWxvcG1lbnRcXE5leHRcXHNvcnljay1hY2Nlc3NcXHNyY1xcX190ZXN0c19fXFxjb21wb25lbnRzXFxjb3VydGVzeS1pbnZpdGF0aW9ucy1tYW5hZ2VtZW50LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBUZXN0cyBwYXJhIGVsIGNvbXBvbmVudGUgQ291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnRcclxuICogQGZpbGUgY29tcG9uZW50cy9jb3VydGVzeS1pbnZpdGF0aW9ucy1tYW5hZ2VtZW50LnRzeFxyXG4gKi9cclxuXHJcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcclxuaW1wb3J0IHsgdG9hc3QgfSBmcm9tICdzb25uZXInO1xyXG5pbXBvcnQgQ291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb3VydGVzeS1pbnZpdGF0aW9ucy1tYW5hZ2VtZW50JztcclxuXHJcbi8vIE1vY2sgZGUgU29ubmVyIFRvYXN0XHJcbmplc3QubW9jaygnc29ubmVyJywgKCkgPT4gKHtcclxuICB0b2FzdDoge1xyXG4gICAgZXJyb3I6IGplc3QuZm4oKSxcclxuICAgIHN1Y2Nlc3M6IGplc3QuZm4oKSxcclxuICAgIHdhcm5pbmc6IGplc3QuZm4oKSxcclxuICB9LFxyXG59KSk7XHJcblxyXG4vLyBNb2NrIGRlIGZldGNoIGdsb2JhbFxyXG5jb25zdCBtb2NrRmV0Y2ggPSBqZXN0LmZuKCk7XHJcbmdsb2JhbC5mZXRjaCA9IG1vY2tGZXRjaDtcclxuXHJcbi8vIE1vY2sgZGUgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwgcGFyYSBleHBvcnRhclxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnVVJMJywge1xyXG4gIHZhbHVlOiB7XHJcbiAgICBjcmVhdGVPYmplY3RVUkw6IGplc3QuZm4oKCkgPT4gJ21vY2stdXJsJyksXHJcbiAgICByZXZva2VPYmplY3RVUkw6IGplc3QuZm4oKSxcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIE1vY2sgZGUgY3JlYXRlRWxlbWVudCBwYXJhIGxpbmsgZGUgZGVzY2FyZ2FcclxuY29uc3QgbW9ja0NyZWF0ZUVsZW1lbnQgPSBqZXN0LmZuKCk7XHJcbmNvbnN0IG1vY2tDbGljayA9IGplc3QuZm4oKTtcclxuY29uc3QgbW9ja1JlbW92ZSA9IGplc3QuZm4oKTtcclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkb2N1bWVudCwgJ2NyZWF0ZUVsZW1lbnQnLCB7XHJcbiAgdmFsdWU6IG1vY2tDcmVhdGVFbGVtZW50Lm1vY2tSZXR1cm5WYWx1ZSh7XHJcbiAgICBocmVmOiAnJyxcclxuICAgIGRvd25sb2FkOiAnJyxcclxuICAgIHN0eWxlOiB7IGRpc3BsYXk6ICcnIH0sXHJcbiAgICBjbGljazogbW9ja0NsaWNrLFxyXG4gICAgcmVtb3ZlOiBtb2NrUmVtb3ZlLFxyXG4gIH0pLFxyXG59KTtcclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkb2N1bWVudC5ib2R5LCAnYXBwZW5kQ2hpbGQnLCB7XHJcbiAgdmFsdWU6IGplc3QuZm4oKSxcclxufSk7XHJcblxyXG5kZXNjcmliZSgnQ291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQnLCAoKSA9PiB7XHJcbiAgY29uc3QgbW9ja1Byb3BzID0ge1xyXG4gICAgZXZlbnRJZDogJ2V2ZW50LTEyMycsXHJcbiAgICBldmVudFRpdGxlOiAnVGVzdCBFdmVudCcsXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgbW9ja0ludml0YXRpb25zID0gW1xyXG4gICAge1xyXG4gICAgICBpZDogJ2ludi0xJyxcclxuICAgICAgaW52aXRlZEVtYWlsOiAndGVzdDFAZXhhbXBsZS5jb20nLFxyXG4gICAgICBpbnZpdGVkTmFtZTogJ1Rlc3QgVXNlciAxJyxcclxuICAgICAgc3RhdHVzOiAnUEVORElORycgYXMgY29uc3QsXHJcbiAgICAgIGludml0YXRpb25Db2RlOiAnY29kZTEyMycsXHJcbiAgICAgIGV4cGlyZXNBdDogJzIwMjUtMTItMzFUMjM6NTk6NTlaJyxcclxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wOS0wMVQxMDowMDowMFonLFxyXG4gICAgICB0aWNrZXQ6IG51bGwsXHJcbiAgICAgIGNyZWF0b3I6IHtcclxuICAgICAgICBmaXJzdE5hbWU6ICdKb2huJyxcclxuICAgICAgICBsYXN0TmFtZTogJ0RvZScsXHJcbiAgICAgICAgZW1haWw6ICdqb2huQHRlc3QuY29tJyxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGlkOiAnaW52LTInLFxyXG4gICAgICBpbnZpdGVkRW1haWw6ICd0ZXN0MkBleGFtcGxlLmNvbScsXHJcbiAgICAgIGludml0ZWROYW1lOiAnVGVzdCBVc2VyIDInLFxyXG4gICAgICBzdGF0dXM6ICdTRU5UJyBhcyBjb25zdCxcclxuICAgICAgaW52aXRhdGlvbkNvZGU6ICdjb2RlNDU2JyxcclxuICAgICAgZXhwaXJlc0F0OiAnMjAyNS0xMi0zMVQyMzo1OTo1OVonLFxyXG4gICAgICBjcmVhdGVkQXQ6ICcyMDI1LTA5LTAxVDExOjAwOjAwWicsXHJcbiAgICAgIHRpY2tldDoge1xyXG4gICAgICAgIGlkOiAndGlja2V0LTEnLFxyXG4gICAgICAgIHFyQ29kZTogJ1FSMTIzJyxcclxuICAgICAgICBpc1VzZWQ6IGZhbHNlLFxyXG4gICAgICAgIHVzZWRBdDogbnVsbCxcclxuICAgICAgfSxcclxuICAgICAgY3JlYXRvcjoge1xyXG4gICAgICAgIGZpcnN0TmFtZTogJ0pvaG4nLFxyXG4gICAgICAgIGxhc3ROYW1lOiAnRG9lJyxcclxuICAgICAgICBlbWFpbDogJ2pvaG5AdGVzdC5jb20nLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICBdO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgbW9ja0ZldGNoLm1vY2tDbGVhcigpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnUmVuZGVyaXphZG8gaW5pY2lhbCcsICgpID0+IHtcclxuICAgIGl0KCdkZWJlcsOtYSByZW5kZXJpemFyIGVsIHTDrXR1bG8geSBlbGVtZW50b3MgcHJpbmNpcGFsZXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XHJcbiAgICAgICAgICBldmVudDogeyBpZDogJ2V2ZW50LTEyMycsIHRpdGxlOiAnVGVzdCBFdmVudCcgfSxcclxuICAgICAgICAgIGludml0YXRpb25zOiBbXSxcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZW5kZXIoPENvdXJ0ZXN5SW52aXRhdGlvbnNNYW5hZ2VtZW50IHsuLi5tb2NrUHJvcHN9IC8+KTtcclxuXHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdJbnZpdGFjaW9uZXMgZGUgQ29ydGVzw61hJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBZ3JlZ2FyIEludml0YWNpw7NuIEluZGl2aWR1YWwnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0ludml0YWNpw7NuIE1hc2l2YScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoYC9hcGkvZXZlbnRzLyR7bW9ja1Byb3BzLmV2ZW50SWR9L2ludml0YXRpb25zYCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RlYmVyw61hIG1vc3RyYXIgbGEgdGFibGEgZGUgaW52aXRhY2lvbmVzIGN1YW5kbyBoYXkgZGF0b3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XHJcbiAgICAgICAgICBldmVudDogeyBpZDogJ2V2ZW50LTEyMycsIHRpdGxlOiAnVGVzdCBFdmVudCcgfSxcclxuICAgICAgICAgIGludml0YXRpb25zOiBtb2NrSW52aXRhdGlvbnMsXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyKDxDb3VydGVzeUludml0YXRpb25zTWFuYWdlbWVudCB7Li4ubW9ja1Byb3BzfSAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgndGVzdDFAZXhhbXBsZS5jb20nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBVc2VyIDEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgndGVzdDJAZXhhbXBsZS5jb20nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBVc2VyIDInKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUEVORElORycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU0VOVCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RlYmVyw61hIG1hbmVqYXIgZXJyb3JlcyBhbCBjYXJnYXIgaW52aXRhY2lvbmVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWVPbmNlKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKTtcclxuXHJcbiAgICAgIHJlbmRlcig8Q291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgey4uLm1vY2tQcm9wc30gLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHRvYXN0LmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRXJyb3IgYWwgY2FyZ2FyIGxhcyBpbnZpdGFjaW9uZXMnKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0ludml0YWNpw7NuIGluZGl2aWR1YWwnLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgb2s6IHRydWUsXHJcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcclxuICAgICAgICAgIGV2ZW50OiB7IGlkOiAnZXZlbnQtMTIzJywgdGl0bGU6ICdUZXN0IEV2ZW50JyB9LFxyXG4gICAgICAgICAgaW52aXRhdGlvbnM6IFtdLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSBhZ3JlZ2FyIHVuYSBpbnZpdGFjacOzbiBpbmRpdmlkdWFsIGV4aXRvc2FtZW50ZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgLy8gTW9jayByZXNwdWVzdGEgZXhpdG9zYSBwYXJhIGNyZWFyIGludml0YWNpw7NuXHJcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XHJcbiAgICAgICAgICBtZXNzYWdlOiAnMSBpbnZpdGFjacOzbihlcykgY3JlYWRhKHMpIGV4aXRvc2FtZW50ZScsXHJcbiAgICAgICAgICBpbnZpdGF0aW9uczogW21vY2tJbnZpdGF0aW9uc1swXV0sXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyKDxDb3VydGVzeUludml0YXRpb25zTWFuYWdlbWVudCB7Li4ubW9ja1Byb3BzfSAvPik7XHJcblxyXG4gICAgICAvLyBFc3BlcmFyIGEgcXVlIGNhcmd1ZVxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdFbWFpbCAqJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gTGxlbmFyIGZvcm11bGFyaW9cclxuICAgICAgY29uc3QgZW1haWxJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgKicpO1xyXG4gICAgICBjb25zdCBuYW1lSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ05vbWJyZSAob3BjaW9uYWwpJyk7XHJcbiAgICAgIFxyXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKGVtYWlsSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnbmV3QGV4YW1wbGUuY29tJyB9IH0pO1xyXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKG5hbWVJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdOZXcgVXNlcicgfSB9KTtcclxuXHJcbiAgICAgIC8vIEVudmlhclxyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAnQWdyZWdhciBJbnZpdGFjacOzbicgfSkpO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoKFxyXG4gICAgICAgICAgYC9hcGkvZXZlbnRzLyR7bW9ja1Byb3BzLmV2ZW50SWR9L2ludml0YXRpb25zYCxcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgaW52aXRlZEVtYWlsOiAnbmV3QGV4YW1wbGUuY29tJyxcclxuICAgICAgICAgICAgICBpbnZpdGVkTmFtZTogJ05ldyBVc2VyJyxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICBleHBlY3QodG9hc3Quc3VjY2VzcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0ludml0YWNpw7NuIGNyZWFkYSBleGl0b3NhbWVudGUnKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGViZXLDrWEgdmFsaWRhciBlbWFpbCByZXF1ZXJpZG8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHJlbmRlcig8Q291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgey4uLm1vY2tQcm9wc30gLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgKicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEludGVudGFyIGVudmlhciBzaW4gZW1haWxcclxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogJ0FncmVnYXIgSW52aXRhY2nDs24nIH0pKTtcclxuXHJcbiAgICAgIGV4cGVjdCh0b2FzdC5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0VsIGVtYWlsIGVzIHJlcXVlcmlkbycpO1xyXG4gICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7IC8vIFNvbG8gbGEgY2FyZ2EgaW5pY2lhbFxyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RlYmVyw61hIG1hbmVqYXIgZXJyb3JlcyBhbCBjcmVhciBpbnZpdGFjacOzbiBpbmRpdmlkdWFsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBNb2NrIGVycm9yIGVuIGNyZWFjacOzblxyXG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcclxuICAgICAgICBvazogZmFsc2UsXHJcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHsgZXJyb3I6ICdFbWFpbCB5YSBleGlzdGUnIH0pLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcig8Q291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgey4uLm1vY2tQcm9wc30gLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgKicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnN0IGVtYWlsSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0VtYWlsIConKTtcclxuICAgICAgZmlyZUV2ZW50LmNoYW5nZShlbWFpbElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2V4aXN0aW5nQGV4YW1wbGUuY29tJyB9IH0pO1xyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAnQWdyZWdhciBJbnZpdGFjacOzbicgfSkpO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHRvYXN0LmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnRW1haWwgeWEgZXhpc3RlJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdJbnZpdGFjaW9uZXMgbWFzaXZhcycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcclxuICAgICAgICBvazogdHJ1ZSxcclxuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xyXG4gICAgICAgICAgZXZlbnQ6IHsgaWQ6ICdldmVudC0xMjMnLCB0aXRsZTogJ1Rlc3QgRXZlbnQnIH0sXHJcbiAgICAgICAgICBpbnZpdGF0aW9uczogW10sXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2RlYmVyw61hIGFicmlyIGVsIG1vZGFsIGRlIGludml0YWNpb25lcyBtYXNpdmFzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICByZW5kZXIoPENvdXJ0ZXN5SW52aXRhdGlvbnNNYW5hZ2VtZW50IHsuLi5tb2NrUHJvcHN9IC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdJbnZpdGFjacOzbiBNYXNpdmEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvSW52aXRhY2nDs24gTWFzaXZhL2kgfSkpO1xyXG5cclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FncmVnYSBtw7psdGlwbGVzIGVtYWlscyBzZXBhcmFkb3MgcG9yIGzDrW5lYXMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVBsYWNlaG9sZGVyVGV4dCgvdXN1YXJpbzFAZWplbXBsby5jb20vKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSB2YWxpZGFyIHF1ZSBzZSBhZ3JlZ3VlIGFsIG1lbm9zIHVuIGVtYWlsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICByZW5kZXIoPENvdXJ0ZXN5SW52aXRhdGlvbnNNYW5hZ2VtZW50IHsuLi5tb2NrUHJvcHN9IC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdJbnZpdGFjacOzbiBNYXNpdmEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvSW52aXRhY2nDs24gTWFzaXZhL2kgfSkpO1xyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAnQ3JlYXIgSW52aXRhY2lvbmVzJyB9KSk7XHJcblxyXG4gICAgICBleHBlY3QodG9hc3QuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdEZWJlcyBhZ3JlZ2FyIGFsIG1lbm9zIHVuIGVtYWlsJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGViZXLDrWEgcHJvY2VzYXIgaW52aXRhY2lvbmVzIG1hc2l2YXMgZXhpdG9zYW1lbnRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBNb2NrIHJlc3B1ZXN0YSBleGl0b3NhIHBhcmEgaW52aXRhY2lvbmVzIG1hc2l2YXNcclxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgb2s6IHRydWUsXHJcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcclxuICAgICAgICAgIGNyZWF0ZWQ6IFttb2NrSW52aXRhdGlvbnNbMF0sIG1vY2tJbnZpdGF0aW9uc1sxXV0sXHJcbiAgICAgICAgICBlcnJvcnM6IFtdLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcig8Q291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgey4uLm1vY2tQcm9wc30gLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0ludml0YWNpw7NuIE1hc2l2YScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIEFicmlyIG1vZGFsXHJcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9JbnZpdGFjacOzbiBNYXNpdmEvaSB9KSk7XHJcblxyXG4gICAgICAvLyBMbGVuYXIgdGV4dGFyZWEgY29uIG3Dumx0aXBsZXMgZW1haWxzXHJcbiAgICAgIGNvbnN0IHRleHRhcmVhID0gc2NyZWVuLmdldEJ5UGxhY2Vob2xkZXJUZXh0KC91c3VhcmlvMUBlamVtcGxvLmNvbS8pO1xyXG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHRleHRhcmVhLCB7IFxyXG4gICAgICAgIHRhcmdldDogeyB2YWx1ZTogJ3VzZXIxQHRlc3QuY29tLCBVc2VyIE9uZVxcbnVzZXIyQHRlc3QuY29tLCBVc2VyIFR3b1xcbnVzZXIzQHRlc3QuY29tJyB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gRW52aWFyXHJcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6ICdDcmVhciBJbnZpdGFjaW9uZXMnIH0pKTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGV4cGVjdChtb2NrRmV0Y2gpLnRvSGF2ZUJlZW5MYXN0Q2FsbGVkV2l0aChcclxuICAgICAgICAgIGAvYXBpL2V2ZW50cy8ke21vY2tQcm9wcy5ldmVudElkfS9pbnZpdGF0aW9uc2AsXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgIGludml0YXRpb25zOiBbXHJcbiAgICAgICAgICAgICAgICB7IGVtYWlsOiAndXNlcjFAdGVzdC5jb20nLCBuYW1lOiAnVXNlciBPbmUnIH0sXHJcbiAgICAgICAgICAgICAgICB7IGVtYWlsOiAndXNlcjJAdGVzdC5jb20nLCBuYW1lOiAnVXNlciBUd28nIH0sXHJcbiAgICAgICAgICAgICAgICB7IGVtYWlsOiAndXNlcjNAdGVzdC5jb20nLCBuYW1lOiB1bmRlZmluZWQgfSxcclxuICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIGV4cGVjdCh0b2FzdC5zdWNjZXNzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnMiBpbnZpdGFjaW9uZXMgY3JlYWRhcyBleGl0b3NhbWVudGUnKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0V4cG9ydGFyIGludml0YWNpb25lcycsICgpID0+IHtcclxuICAgIGl0KCdkZWJlcsOtYSBleHBvcnRhciBpbnZpdGFjaW9uZXMgYSBDU1YnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tGZXRjaC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xyXG4gICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XHJcbiAgICAgICAgICBldmVudDogeyBpZDogJ2V2ZW50LTEyMycsIHRpdGxlOiAnVGVzdCBFdmVudCcgfSxcclxuICAgICAgICAgIGludml0YXRpb25zOiBtb2NrSW52aXRhdGlvbnMsXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmVuZGVyKDxDb3VydGVzeUludml0YXRpb25zTWFuYWdlbWVudCB7Li4ubW9ja1Byb3BzfSAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgndGVzdDFAZXhhbXBsZS5jb20nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvRXhwb3J0YXIvaSB9KSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja0NyZWF0ZUVsZW1lbnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdhJyk7XHJcbiAgICAgIGV4cGVjdChtb2NrQ2xpY2spLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgICAgZXhwZWN0KG1vY2tSZW1vdmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdkZWJlcsOtYSBtb3N0cmFyIG1lbnNhamUgY3VhbmRvIG5vIGhheSBpbnZpdGFjaW9uZXMgcGFyYSBleHBvcnRhcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XHJcbiAgICAgICAgb2s6IHRydWUsXHJcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcclxuICAgICAgICAgIGV2ZW50OiB7IGlkOiAnZXZlbnQtMTIzJywgdGl0bGU6ICdUZXN0IEV2ZW50JyB9LFxyXG4gICAgICAgICAgaW52aXRhdGlvbnM6IFtdLFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJlbmRlcig8Q291cnRlc3lJbnZpdGF0aW9uc01hbmFnZW1lbnQgey4uLm1vY2tQcm9wc30gLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL0V4cG9ydGFyL2kgfSkpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL0V4cG9ydGFyL2kgfSkpO1xyXG5cclxuICAgICAgZXhwZWN0KHRvYXN0LmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnTm8gaGF5IGludml0YWNpb25lcyBwYXJhIGV4cG9ydGFyJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==